{"version":3,"sources":["components/Title.tsx","components/SubTitle.tsx","utils/css.ts","components/Card.tsx","components/ErrorView.tsx","components/LoadingView.tsx","utils/notNullish.ts","utils/apmRepoIsAllowed.ts","utils/getLatestVersion.ts","utils/fetchManifest.ts","utils/isValidBump.ts","utils/isIpfsHash.ts","utils/isValidEns.ts","utils/newTabProps.ts","App.tsx","utils/urlQuery.ts","params.ts","index.tsx","utils/resolveDnpName.ts","utils/executePublishTx.ts","img/metamask-white.png"],"names":["Title","title","subtitle","children","className","SubTitle","joinCssClass","args","reduce","classNames","arg","push","Object","entries","key","join","shadowStyle","boxShadow","Card","shadow","spacing","divider","noscroll","props","style","overflowX","Body","ErrorView","error","Error","message","detail","stack","JSON","stringify","parseError","split","LoadingView","steps","useState","index","setIndex","useEffect","interval","setInterval","i","clearInterval","length","ProgressBar","animated","now","notNullish","value","undefined","apmRepoIsAllowed","repoAddress","userAddress","provider","a","repo","ethers","Contract","repoContract","abi","canPerform","getLatest","res","semanticVersion","hash","IPFS_GATEWAY","fetch","then","json","releaseTypes","isValidBump","prevVersion","nextVersion","type","semver","inc","isIpfsHash","includes","replace","isIPFS","cid","isMultihash","isValidEns","ensDomain","newTabProps","rel","target","fetchManifestMem","memoizee","promise","resolveDnpNameMem","resolveDnpName","getLatestVersionMem","getInputClass","success","App","dnpName","setDnpName","version","setVersion","developerAddress","setDeveloperAddress","manifestHash","setManifestHash","manifest","setManifest","repoAddresses","setRepoAddresses","latestVersion","setLatestVersion","providerReq","setProviderReq","publishReqStatus","setPublishReqStatus","result","urlParams","params","startsWith","slice","obj","pair","decodeURIComponent","parseUrlQuery","window","location","search","console","log","r","v","d","h","ethereum","on","accounts","onNewManifestHash","useMemo","debounce","catch","e","onNewDnpName","loading","enable","providers","Web3Provider","web3","currentProvider","getNetwork","network","String","chainId","listAccounts","executePublishTx","txHash","fields","id","name","placeholder","help","onValueChange","validations","isValid","registryAddress","utils","isAddress","valid","role","backgroundColor","href","map","field","filter","errors","Fragment","onChange","item","disabled","onClick","src","metamaskIcon","alt","ReactDOM","render","StrictMode","document","getElementById","registryName","parseRegistryName","Promise","all","resolveEns","ensName","resolveName","repoName","signer","getSigner","contentURI","Buffer","from","toString","contractAddress","shortName","populateTransaction","newVersion","unsignedTx","registry","registryContract","newRepoWithVersion","sendTransaction","txResponse","module","exports"],"mappings":"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","file":"static/js/main.e294b853.chunk.js","sourcesContent":["import React from \"react\";\n\ninterface TitleProps {\n  title: string;\n  subtitle?: string;\n}\n\nexport const Title: React.FunctionComponent<TitleProps> = ({\n  title,\n  subtitle,\n  children,\n}) => {\n  if (children) return <div className=\"section-title\">{children}</div>;\n  if (subtitle)\n    return (\n      <div className=\"section-title\">\n        <span className=\"pre-title\">{title} </span>\n        {subtitle}\n      </div>\n    );\n  return <div className=\"section-title\">{title}</div>;\n};\n","import React from \"react\";\n\nexport const SubTitle: React.FunctionComponent<{ className?: string }> = ({\n  children,\n  className,\n}) => <div className={`section-subtitle ${className || \"\"}`}>{children}</div>;\n","type CssClass =\n  | { [className: string]: string | undefined | null | boolean }\n  | string\n  | undefined\n  | null;\n\n/**\n *\n * @param cssClassObj\n */\nexport function joinCssClass(...args: CssClass[]): string {\n  return args\n    .reduce((classNames, arg) => {\n      if (typeof arg === \"string\") classNames.push(arg);\n      if (typeof arg === \"object\")\n        for (const [key, val] of Object.entries(arg || {}))\n          if (val) classNames.push(key);\n      return classNames;\n    }, [] as string[])\n    .join(\" \");\n}\n","import React from \"react\";\nimport BootstrapCard from \"react-bootstrap/Card\";\nimport { joinCssClass } from \"../utils/css\";\n\nconst shadowStyle = { boxShadow: \"1px 1px 15px 0 rgba(0, 0, 0, 0.07)\" };\n\ninterface CardProps {\n  shadow?: boolean;\n  spacing?: boolean;\n  divider?: boolean;\n  noscroll?: boolean;\n}\n\n/**\n * [NOTE] style is injected to the card-body div via ...props\n */\nexport const Card: React.FunctionComponent<\n  CardProps & React.HTMLAttributes<HTMLDivElement>\n> = ({\n  children,\n  className = \"\",\n  shadow,\n  spacing,\n  divider,\n  noscroll,\n  ...props\n}) => (\n  <BootstrapCard\n    style={{\n      overflowX: noscroll ? \"visible\" : \"auto\",\n      ...(shadow ? shadowStyle : {}),\n    }}\n  >\n    <BootstrapCard.Body\n      className={joinCssClass({\n        spacing,\n        divider,\n        noscroll,\n        [className]: className,\n      })}\n      {...props}\n    >\n      {children}\n    </BootstrapCard.Body>\n  </BootstrapCard>\n);\n","import React from \"react\";\nimport \"./errorView.css\";\n\nfunction parseError(\n  error: Error | { message: string; stack: string } | string\n) {\n  if (error instanceof Error || (typeof error === \"object\" && error.message))\n    return { message: error.message, detail: error.stack };\n  if (typeof error === \"string\") return { message: error };\n  return { message: JSON.stringify(error), detail: \"\" };\n}\n\nexport function ErrorView({ error }: { error: Error | string }) {\n  const { message, detail } = parseError(error);\n\n  return (\n    <div className=\"errorView\">\n      <details>\n        <summary>{message.split(\"\\n\")[0]}</summary>\n        <pre>{detail}</pre>\n      </details>\n    </div>\n  );\n}\n","import React, { useState, useEffect } from \"react\";\nimport ProgressBar from \"react-bootstrap/ProgressBar\";\n\nexport function LoadingView({ steps }: { steps?: string[] }) {\n  const [index, setIndex] = useState(0);\n  useEffect(() => {\n    const interval = setInterval(() => setIndex((i) => i + 1), 3000);\n    return () => clearInterval(interval);\n  }, []);\n\n  return (\n    <div className=\"loadingView\">\n      {steps && (\n        <div className=\"steps text-muted\">\n          {steps[index] || steps[steps.length - 1]}...\n        </div>\n      )}\n      <ProgressBar animated now={100} />\n    </div>\n  );\n}\n","/**\n * Type-safe helper to filter out nullist values from an array\n * ```js\n * const array: (string | null)[] = ['foo', null];\n * const filteredArray: string[] = array.filter(notEmpty);\n * ```\n * @param value\n */\nexport function notNullish<TValue>(\n  value: TValue | null | undefined\n): value is TValue {\n  return value !== null && value !== undefined;\n}\n","import { ethers } from \"ethers\";\nimport repoContract from \"contracts/repository.json\";\n\nexport async function apmRepoIsAllowed(\n  repoAddress: string,\n  userAddress: string,\n  provider: ethers.providers.Provider\n): Promise<boolean> {\n  const repo = new ethers.Contract(repoAddress, repoContract.abi, provider);\n\n  try {\n    return await repo.canPerform(\n      userAddress,\n      \"0x0000000000000000000000000000000000000000000000000000000000000001\",\n      []\n    );\n  } catch (e) {\n    // Rename error for user comprehension\n    e.message = `Error calling canPerform(${userAddress}): ${e.message}`;\n    throw e;\n  }\n}\n","import { ethers } from \"ethers\";\nimport repoContract from \"contracts/repository.json\";\n\nexport async function getLatestVersion(\n  repoAddress: string,\n  provider: ethers.providers.Provider\n): Promise<string> {\n  const repo = new ethers.Contract(repoAddress, repoContract.abi, provider);\n\n  try {\n    const res = await repo.getLatest();\n    return res.semanticVersion.join(\".\");\n  } catch (e) {\n    // Rename error for user comprehension\n    e.message = `Error getting latest version of ${repoAddress}: ${e.message}`;\n    throw e;\n  }\n}\n","import { Manifest } from \"types\";\n\nexport async function fetchManifest(\n  hash: string,\n  IPFS_GATEWAY: string\n): Promise<Manifest> {\n  try {\n    return await fetch(\n      `${IPFS_GATEWAY}${hash}/dappnode_package.json`\n    ).then((res) => res.json());\n  } catch (e) {\n    return await fetch(`${IPFS_GATEWAY}${hash}`).then((res) => res.json());\n  }\n}\n","import semver from \"semver\";\n\nconst releaseTypes: semver.ReleaseType[] = [\"patch\", \"minor\", \"major\"];\n\nexport function isValidBump(prevVersion: string, nextVersion: string): boolean {\n  for (const type of releaseTypes) {\n    if (semver.inc(prevVersion, type) === nextVersion) return true;\n  }\n  return false;\n}\n","// @ts-ignore // No type definitions for \"is-ipfs\"\nimport isIPFS from \"is-ipfs\";\n\nfunction isMultihash(hash: string) {\n  return isIPFS.cid(hash);\n}\n\n/**\n * Checks if the given string is a valid IPFS CID or path\n *\n * isIPFS.cid('QmYjtig7VJQ6XsnUjqqJvj7QaMcCAwtrgNdahSiFofrE7o') // true (CIDv0)\n * isIPFS.cid('zdj7WWeQ43G6JJvLWQWZpyHuAMq6uYWRjkBXFad11vE2LHhQ7') // true (CIDv1)\n * isIPFS.cid('noop') // false\n *\n * @param hash\n */\nexport function isIpfsHash(hash: string): boolean {\n  if (!hash || typeof hash !== \"string\") return false;\n  // Correct hash prefix\n  if (hash.includes(\"ipfs/\")) {\n    hash = hash.split(\"ipfs/\")[1];\n  }\n  hash.replace(\"/\", \"\");\n  // Make sure hash if valid\n  return isMultihash(hash);\n}\n","export function isValidEns(ensDomain: string): boolean {\n  return ensDomain.includes(\".\");\n}\n","// Props to be passed to a JSX <a> element to open a new tab\n// The purpose of this utility is to centralize this props.\n// To disable the newTab openning for certain <a> from the whole project, edit this file\n//\n// It converts:\n//   <a href={url} rel=\"noopener noreferrer\" target=\"_blank\">\n// Into:\n//   <a href={url} {...newTabProps}>\n\nexport const newTabProps = { rel: \"noopener noreferrer\", target: \"_blank\" };\n","import React, { useState, useEffect, useMemo } from \"react\";\nimport { ethers } from \"ethers\";\nimport memoizee from \"memoizee\";\nimport { debounce } from \"lodash\";\nimport semver from \"semver\";\n// Components\nimport { Title } from \"components/Title\";\nimport { SubTitle } from \"components/SubTitle\";\nimport { Card } from \"components/Card\";\nimport { ErrorView } from \"components/ErrorView\";\nimport { LoadingView } from \"components/LoadingView\";\n// Utils\nimport { parseUrlQuery } from \"utils/urlQuery\";\nimport { notNullish } from \"utils/notNullish\";\nimport { executePublishTx } from \"utils/executePublishTx\";\nimport { apmRepoIsAllowed } from \"utils/apmRepoIsAllowed\";\nimport { getLatestVersion } from \"utils/getLatestVersion\";\nimport { fetchManifest } from \"utils/fetchManifest\";\nimport { resolveDnpName } from \"utils/resolveDnpName\";\nimport { isValidBump } from \"utils/isValidBump\";\nimport { isIpfsHash } from \"utils/isIpfsHash\";\nimport { isValidEns } from \"utils/isValidEns\";\nimport { newTabProps } from \"utils/newTabProps\";\n// Imgs\nimport metamaskIcon from \"./img/metamask-white.png\";\nimport { RequestStatus, RepoAddresses, Manifest, FormField } from \"types\";\nimport { IPFS_GATEWAY, SDK_INSTALL_URL } from \"params\";\n\nconst fetchManifestMem = memoizee(fetchManifest, { promise: true });\nconst resolveDnpNameMem = memoizee(resolveDnpName, { promise: true });\nconst getLatestVersionMem = memoizee(getLatestVersion, { promise: true });\n\n/**\n * Convert to react-boostrap classes\n */\nconst getInputClass = ({\n  success,\n  error,\n}: {\n  success?: boolean;\n  error?: boolean;\n}) => (error ? \"is-invalid\" : success ? \"is-valid\" : \"\");\n\nexport function App() {\n  // Form input variables\n  const [dnpName, setDnpName] = useState(\"\");\n  const [version, setVersion] = useState(\"\");\n  const [developerAddress, setDeveloperAddress] = useState(\"\");\n  const [manifestHash, setManifestHash] = useState(\"\");\n  const [manifest, setManifest] = useState<Manifest & { hash: string }>();\n  const [repoAddresses, setRepoAddresses] = useState<RepoAddresses>();\n  const [latestVersion, setLatestVersion] = useState<string>();\n  const [providerReq, setProviderReq] = useState<\n    RequestStatus<ethers.providers.Web3Provider>\n  >({});\n  const [publishReqStatus, setPublishReqStatus] = useState<\n    RequestStatus<string>\n  >({});\n\n  // Precomputed variables\n  const provider = providerReq.result;\n\n  /**\n   * Grab the params from the URL and update local state\n   * - Only once every mount, unmount\n   */\n  useEffect(() => {\n    const urlParams = parseUrlQuery(window.location.search);\n    console.log(\"URL params\", urlParams);\n    if (urlParams.r) setDnpName(urlParams.r);\n    if (urlParams.v) setVersion(urlParams.v);\n    if (urlParams.d) setDeveloperAddress(urlParams.d);\n    if (urlParams.h) setManifestHash(urlParams.h);\n  }, []);\n\n  useEffect(() => {\n    // Necessary code to refresh the userAddress\n    // when user interacts with the metamask extension\n    // @ts-ignore\n    const ethereum = window.ethereum;\n    if (ethereum)\n      ethereum.on(\"accountsChanged\", (accounts: string[]) => {\n        console.log(\"new user account\", accounts[0]);\n      });\n  }, []);\n\n  // Check manifest for manifestHash\n\n  const onNewManifestHash = useMemo(\n    () =>\n      debounce((hash: string) => {\n        fetchManifestMem(hash, IPFS_GATEWAY)\n          .then((manifest) => setManifest({ ...manifest, hash }))\n          .catch((e) => console.error(`Error fetching manifest ${hash}`, e));\n      }, 500),\n    []\n  );\n  const onNewDnpName = useMemo(\n    () =>\n      debounce((dnpName: string, provider: ethers.providers.Provider) => {\n        console.log(\"ON NEW DNP\", dnpName);\n        resolveDnpNameMem(dnpName, provider)\n          .then(setRepoAddresses)\n          .catch((e) => console.error(`Error resolving dnpName ${dnpName}`, e));\n        getLatestVersionMem(dnpName, provider)\n          .then(setLatestVersion)\n          .catch((e) => console.error(`Error get latest ver ${dnpName}`, e));\n      }, 500),\n    []\n  );\n\n  useEffect(() => {\n    if (manifestHash) onNewManifestHash(manifestHash);\n  }, [manifestHash, onNewManifestHash]);\n\n  useEffect(() => {\n    if (dnpName && isValidEns(dnpName) && provider)\n      onNewDnpName(dnpName, provider);\n  }, [dnpName, provider, onNewDnpName]);\n\n  async function connectToMetamask() {\n    try {\n      setProviderReq({ loading: true });\n      // Modern dapp browsers...\n      if (window.ethereum) {\n        // Request account access if needed\n        await window.ethereum.enable();\n        // Acccounts now exposed\n        setProviderReq({\n          result: new ethers.providers.Web3Provider(window.ethereum),\n        });\n      }\n      // Legacy dapp browsers...\n      else if (window.web3) {\n        setProviderReq({\n          result: new ethers.providers.Web3Provider(\n            window.web3.currentProvider\n          ),\n        });\n      }\n      // Non-dapp browsers...\n      else {\n        throw Error(\"Non-Ethereum browser detected. Please, install MetaMask\");\n      }\n    } catch (e) {\n      setProviderReq({ error: e });\n    }\n  }\n\n  async function publish() {\n    try {\n      if (!dnpName) throw Error(\"Must provide a dnpName\");\n      if (!version) throw Error(\"Must provide a version\");\n      if (!manifestHash) throw Error(\"Must provide a manifestHash\");\n\n      setPublishReqStatus({ loading: true });\n\n      if (!provider) throw Error(`Must connect to Metamask first`);\n      const network = await provider.getNetwork();\n\n      if (network && String(network.chainId) !== \"1\")\n        throw Error(\"Transactions must be published on Ethereum Mainnet\");\n\n      const accounts = await provider.listAccounts();\n      const userAddress = accounts[0];\n      if (userAddress) {\n        const { repoAddress } = await resolveDnpNameMem(dnpName, provider);\n        if (repoAddress) {\n          const isAllowed = await apmRepoIsAllowed(\n            repoAddress,\n            userAddress,\n            provider\n          );\n          if (!isAllowed)\n            throw Error(\n              `Selected address ${userAddress} is not allowed to publish`\n            );\n        }\n      }\n\n      const txHash = await executePublishTx(\n        { dnpName, version, manifestHash, developerAddress },\n        provider\n      );\n      setPublishReqStatus({ result: txHash });\n    } catch (e) {\n      setPublishReqStatus({ error: e });\n    }\n  }\n\n  /**\n   * Description of the input fields\n   */\n  const fields: FormField[] = [\n    {\n      id: \"dnpName\",\n      name: \"DAppNode Package name\",\n      placeholder: \"full ENS name\",\n      help:\n        \"ENS name of the DAppNode Package to update, i.e. timeapp.public.dappnode.eth\",\n      value: dnpName,\n      onValueChange: setDnpName,\n      validations: [\n        dnpName\n          ? isValidEns(dnpName)\n            ? { isValid: true, message: \"Valid ENS domain\" }\n            : { isValid: false, message: \"Invalid ENS domain\" }\n          : null,\n        dnpName && repoAddresses\n          ? repoAddresses.registryAddress\n            ? repoAddresses.repoAddress\n              ? {\n                  isValid: true,\n                  message: `Repo already deployed at: ${repoAddresses.repoAddress}`,\n                }\n              : {\n                  isValid: true,\n                  message: `New repo to be deployed for ${dnpName}`,\n                }\n            : {\n                isValid: false,\n                message: `No valid registry found for ${dnpName}`,\n              }\n          : null,\n      ],\n    },\n    {\n      id: \"developerAddress\",\n      name: \"Developer address\",\n      placeholder: \"Ethereum address\",\n      help: \"Developer's Ethereum address that will control this repo\",\n      value: developerAddress,\n      onValueChange: setDeveloperAddress,\n      validations: [\n        developerAddress\n          ? ethers.utils.isAddress(developerAddress)\n            ? { isValid: true, message: \"Valid address\" }\n            : { isValid: false, message: \"Must be a valid ethereum address\" }\n          : null,\n      ],\n    },\n    {\n      id: \"version\",\n      name: \"Next version\",\n      placeholder: \"Semantic version\",\n      help: \"Semantic version about to be published, i.e. 0.1.7\",\n      value: version,\n      onValueChange: setVersion,\n      validations: [\n        version\n          ? semver.valid(version)\n            ? { isValid: true, message: \"Valid semver\" }\n            : { isValid: false, message: \"Invalid semver\" }\n          : null,\n        version && latestVersion\n          ? isValidBump(latestVersion, version)\n            ? { isValid: true, message: `Valid bump from ${latestVersion}` }\n            : { isValid: false, message: \"Next version is not a valid bump\" }\n          : null,\n      ],\n    },\n    {\n      id: \"manifestIpfsHash\",\n      name: \"Manifest hash\",\n      placeholder: \"IPFS multihash\",\n      help:\n        \"IPFS hash of the manifest. Must be in the format /ipfs/[multihash], i.e. /ipfs/QmVeaz5kR55nAiGjYpXpUAJpWvf6net4MbGFNjBfMTS8xS\",\n      value: manifestHash,\n      onValueChange: setManifestHash,\n      validations: [\n        manifestHash\n          ? isIpfsHash(manifestHash)\n            ? { isValid: true, message: \"Valid ipfs hash\" }\n            : { isValid: false, message: \"Invalid ipfs hash\" }\n          : null,\n        manifest &&\n        manifestHash &&\n        manifestHash === manifest.hash &&\n        manifest.name &&\n        manifest.version\n          ? manifest.name === dnpName && manifest.version === version\n            ? { isValid: true, message: \"Manifest successfully verified\" }\n            : {\n                isValid: false,\n                message: `Manifest verification failed. This manifest is for ${manifest.name} @ ${manifest.version}`,\n              }\n          : null,\n      ],\n    },\n  ];\n\n  return (\n    <div className=\"app\">\n      <Title title=\"SDK\" subtitle=\"Publish\" />\n      <div className=\"mt-3 text-muted\">\n        <p>\n          This tool is part of the DAppNode Software Development Kit\n          (dappnodesdk) and allows to sign DAppNode package release transactions\n          with Metamask.\n        </p>\n        {!window.location.search && (\n          <div\n            className=\"alert alert-secondary\"\n            role=\"alert\"\n            style={{ backgroundColor: \"#f1f1f3\" }}\n          >\n            To generate a pre-filled URL with the parameters to publish a\n            release transaction install{\" \"}\n            <a href={SDK_INSTALL_URL} {...newTabProps}>\n              <code>@dappnode/dappnodesdk</code>\n            </a>\n          </div>\n        )}\n      </div>\n      <SubTitle>Transaction details</SubTitle>\n      <Card>\n        <div className=\"publish-grid\">\n          {fields.map((field) => {\n            const validations = (field.validations || []).filter(notNullish);\n            const success = validations.filter((v) => v && v.isValid);\n            const errors = validations.filter((v) => v && !v.isValid);\n            return (\n              <React.Fragment key={field.name}>\n                <div className=\"field-name\">{field.name}</div>\n                <div>\n                  <input\n                    className={`form-control ${getInputClass({\n                      error: errors.length > 0,\n                      success: success.length > 0,\n                    })}`}\n                    placeholder={field.placeholder}\n                    value={field.value}\n                    onChange={(e) => field.onValueChange(e.target.value)}\n                  />\n                  {success.map((item, i) => (\n                    <div className=\"valid-feedback\">\n                      <div key={i}>{item.message}</div>\n                    </div>\n                  ))}\n                  {errors.map((item, i) => (\n                    <div className=\"invalid-feedback\">\n                      <div key={i}>{item.message}</div>\n                    </div>\n                  ))}\n                  <small className=\"form-text text-muted help\">\n                    {field.help}\n                  </small>\n                </div>\n              </React.Fragment>\n            );\n          })}\n\n          {/* Empty left cell */}\n          <div />\n          <div className=\"bottom-section\">\n            {/* Publish button */}\n            {provider ? (\n              <button\n                className=\"btn btn-dappnode\"\n                disabled={publishReqStatus.loading}\n                onClick={publish}\n              >\n                Publish\n              </button>\n            ) : (\n              <button\n                className=\"btn btn-dappnode\"\n                disabled={providerReq.loading}\n                onClick={connectToMetamask}\n              >\n                <img src={metamaskIcon} alt=\"\" className=\"metamaskIcon\" />{\" \"}\n                Connect to Metamask\n              </button>\n            )}\n\n            {providerReq.error && <ErrorView error={providerReq.error} />}\n            {providerReq.loading && (\n              <LoadingView steps={[\"Connecting to Metamask\"]} />\n            )}\n            {publishReqStatus.error && (\n              <ErrorView error={publishReqStatus.error} />\n            )}\n            {publishReqStatus.loading && (\n              <LoadingView steps={[\"Publishing release transaction\"]} />\n            )}\n            {publishReqStatus.result && (\n              <div className=\"feedback-success\">\n                Published transaction! Tx hash: {publishReqStatus.result}\n              </div>\n            )}\n          </div>\n        </div>\n      </Card>\n    </div>\n  );\n}\n","/**\n * Parses url params into an object\n * Sample params:\n * - timeapp.public.dappnode.eth\n * - 0.1.16\n * - /ipfs/QmSDgpiHco5yXdyVTfhKxr3aiJ82ynz8V14QcGKicM3rVh\n * @param params\n * @returns\n */\nexport const parseUrlQuery = (params = \"\") => {\n  if (params.startsWith(\"?\")) params = params.slice(1);\n  return params.split(\"&\").reduce((obj: { [key: string]: string }, pair) => {\n    const [key, value] = pair.split(\"=\");\n    obj[key] = decodeURIComponent(value);\n    return obj;\n  }, {});\n};\n\n/**\n * Reverse of parseUrlQuery, such that:\n *   params = stringifyUrlQuery(parseUrlQuery(params))\n * @param obj\n * @returns params\n */\nexport const stringifyUrlQuery = (obj: { [key: string]: string }) =>\n  Object.keys(obj)\n    .map((key) => `${key}=${encodeURIComponent(obj[key])}`)\n    .join(\"&\");\n","// IPFS\nexport const IPFS_GATEWAY = \"https://ipfs.io\";\n\nexport const SDK_GUIDE_LINK =\n  \"https://github.com/dappnode/DAppNodeSDK/wiki/DAppNode-SDK-tutorial\";\nexport const SDK_INSTALL_URL = \"https://github.com/dappnode/DAppNodeSDK\";\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { App } from \"./App\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport \"./app.css\";\nimport \"./index.css\";\nimport \"./layout.css\";\nimport \"./dappnode_styles.css\";\nimport \"./dappnode_colors.css\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n","import { ethers } from \"ethers\";\nimport { RepoAddresses } from \"types\";\n\nexport async function resolveDnpName(\n  dnpName: string,\n  provider: ethers.providers.Provider\n): Promise<RepoAddresses> {\n  const registryName = parseRegistryName(dnpName);\n  const [registryAddress, repoAddress] = await Promise.all([\n    resolveEns(registryName, provider),\n    resolveEns(dnpName, provider),\n  ]);\n  return { registryAddress, repoAddress };\n}\n\n// Ens throws if a node is not found\n//\n// ens.resolver('admin.dnp.dappnode.eth').addr()\n// ==> 0xee66c4765696c922078e8670aa9e6d4f6ffcc455\n// ens.resolver('fake.dnp.dappnode.eth').addr()\n// ==> Unhandled rejection Error: ENS name not found\n//\n// Change behaviour to return null if not found\nasync function resolveEns(\n  ensName: string,\n  provider: ethers.providers.Provider\n): Promise<string | null> {\n  try {\n    return await provider.resolveName(ensName);\n  } catch (e) {\n    if (e.message.includes(\"not found\")) return null;\n    else throw e;\n  }\n}\n\nfunction parseRegistryName(repoName: string): string {\n  return repoName.split(\".\").slice(1).join(\".\");\n}\n","import { ethers } from \"ethers\";\nimport registryContract from \"contracts/registry.json\";\nimport repoContract from \"contracts/repository.json\";\nimport { resolveDnpName } from \"./resolveDnpName\";\n\nexport async function executePublishTx(\n  {\n    dnpName,\n    version,\n    manifestHash,\n    developerAddress,\n  }: {\n    dnpName: string;\n    version: string;\n    manifestHash: string;\n    developerAddress?: string;\n  },\n  provider: ethers.providers.Web3Provider\n) {\n  if (!dnpName) throw Error(\"dnpName must be defined\");\n  if (!version) throw Error(\"version must be defined\");\n  if (!manifestHash) throw Error(\"manifestHash must be defined\");\n\n  const signer = provider.getSigner();\n  const { registryAddress, repoAddress } = await resolveDnpName(\n    dnpName,\n    provider\n  );\n\n  // Compute tx data\n  const contentURI = \"0x\" + Buffer.from(manifestHash, \"utf8\").toString(\"hex\");\n  // @param _contractAddress address for smart contract logic for version (if set to 0, it uses last versions' contractAddress)\n  const contractAddress = \"0x0000000000000000000000000000000000000000\";\n  const shortName = dnpName.split(\".\")[0];\n\n  let unsignedTx: ethers.PopulatedTransaction;\n  // If repository exists, push new version to it\n  if (repoAddress) {\n    // newVersion(\n    //     uint16[3] _newSemanticVersion,\n    //     address _contractAddress,\n    //     bytes _contentURI\n    // )\n    const repo = new ethers.Contract(repoAddress, repoContract.abi, signer);\n    unsignedTx = await repo.populateTransaction.newVersion(\n      version.split(\".\"), // uint16[3] _newSemanticVersion\n      contractAddress, // address _contractAddress\n      contentURI // bytes _contentURI\n    );\n  }\n  // If repo does not exist, create a new repo and push version\n  else {\n    // A developer address can be provided by the option developerAddress.\n    // If it is not provided a prompt will ask for it\n\n    if (!developerAddress)\n      throw Error(\"developerAddress must be defined for new repos\");\n\n    if (!registryAddress) throw Error(`No registry found for ${dnpName}`);\n\n    // newRepoWithVersion(\n    //     string _name,\n    //     address _dev,\n    //     uint16[3] _initialSemanticVersion,\n    //     address _contractAddress,\n    //     bytes _contentURI\n    // )\n    const registry = new ethers.Contract(\n      registryAddress,\n      registryContract.abi,\n      signer\n    );\n    unsignedTx = await registry.populateTransaction.newRepoWithVersion(\n      shortName, // string _name\n      developerAddress, // address _dev\n      version.split(\".\"), // uint16[3] _initialSemanticVersion\n      contractAddress, // address _contractAddress\n      contentURI // bytes _contentURI\n    );\n  }\n\n  const txResponse = await signer.sendTransaction(unsignedTx);\n  return txResponse.hash;\n}\n","module.exports = \"data:image/png;base64,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\""],"sourceRoot":""}