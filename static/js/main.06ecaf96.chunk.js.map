{"version":3,"sources":["sdk/sagaUtils/web3.js","sdk/sagaUtils/generatePublishTx.js","sdk/sagaUtils/executePublishTx.js","img/metamask-white.png","sdk/actionTypes.js","sdk/data.ts","sdk/actions.js","utils/isIpfsHash.ts","utils/strings.ts","sdk/selectors.js","sdk/sagaUtils/getRegistry.js","sdk/sagaUtils/getRepo.js","sdk/sagaUtils/getBlockTimestamp.js","sdk/sagaUtils/ens.js","sdk/sagaUtils/resolveEns.js","sdk/sagaUtils/apm.js","sdk/sagaUtils/connectToMetamask.js","sdk/sagas.js","sdk/reducer.js","store.ts","utils/newTabProps.ts","components/Title.tsx","components/SubTitle.tsx","utils/css.ts","components/Card.tsx","App.jsx","utils/urlQuery.ts","serviceWorker.ts","index.tsx","params.ts"],"names":["configureWeb3","process","REACT_APP_MOCK_DATA","TEST","Web3","fullnodeHttpJsonRpc","generateTxWrap","kwargs","ensName","manifestIpfsHash","version","developerAddress","registryAddress","repoAddress","Error","contentURI","Buffer","from","toString","shortName","split","newVersionCall","web3","eth","Contract","repoContract","abi","methods","newVersion","To","Value","Data","encodeABI","newRepoWithVersionCall","registryContract","newRepoWithVersion","generatePublishTx","e","error","message","executePublishTx","a","dnpName","contractAddress","getAccounts","then","res","userAddress","repo","send","gas","value","txHash","console","log","registry","module","exports","generateActionTypes","moduleId","actionTypes","obj","forEach","actionType","updateRegistry","registryEns","data","type","t","UPDATE_REGISTRY","updateRepo","repoName","UPDATE_REPO","updateQuery","id","UPDATE_QUERY","updateQueryResult","UPDATE_QUERY_RESULT","updateGenericError","isIpfsHash","hash","includes","replace","isIPFS","cid","isMultihash","stringIncludes","s","content","toLowerCase","getQuery","state","query","getQueryResult","queryResult","getInputFields","name","placeholder","help","getDnpNameInput","getDeveloperAddressInput","getVersionInput","getManifestHashInput","getQueryResultRepoInfo","repoInfo","success","push","latestVersion","cleanArrays","prevVersion","semver","valid","bumpType","nextVersion","inc","isValidBump","map","join","web3Utils","isAddress","hide","manifestResult","manifest","getQueryResultManifest","getButtonInput","metamaskInfo","getQueryResultMetamaskInfo","allowedAddress","getQueryResultAllowedAddress","callResult","call","getQueryResultCall","ethereum","window","networkId","networkVersion","String","addressNotAllowed","connected","selectedAddress","isAllowed","Object","keys","key","Array","isArray","length","getPastEvents","fromBlock","deployBlock","removeDuplicatedRepos","newRepoEvents","filter","event","returnValues","startsWith","newRepoEvent","address","blockNumber","reduce","item","repoEvents","eventsObj","values","getRegistry","options","year","month","day","getDate","getBlock","catch","stack","block","parseInt","timestamp","getBlockTimestamp","Intl","DateTimeFormat","format","getContentUri","getBySemanticVersion","result","utils","hexToAscii","getSender","getTransaction","txObj","newVersionEvents","Promise","all","reverse","newVersionEvent","semanticVersion","transactionHash","date","sender","contentUri","versions","getRepo","configureEns","_provider","currentProvider","sendAsync","Ens","resolveEns","ens","resolver","addr","repoInstance","getLatest","canPerform","connectToMetamask","enable","connectMetamask","fetchRegistry","onUpdateQuery","rootSingleSaga","fetchManifestFromIpfs","fetch","ipfsGateway","json","put","net","getId","accounts","take","PUBLISH","select","delay","getRegistryFromRepo","slice","resolveRepoName","registryName","fetching","repos","repoData","inputHanlders","onUpdateQueryDnpName","apm","onUpdateQueryUserAddress","onUpdateQueryManifestIpfsHash","ipfsHash","watchers","FETCH_REGISTRY","CONNECT_METAMASK","handler","takeEvery","initialState","registries","uiMessage","sagaMiddleware","createSagaMiddleware","middlewares","store","createStore","action","merge","UPDATE_REPO_NAME","UPDATE_UI_MESSAGE","uiId","applyMiddleware","dispach","dispatch","run","rootSaga","rel","target","Title","title","subtitle","children","className","SubTitle","joinCssClass","args","classNames","arg","entries","shadowStyle","boxShadow","Card","shadow","spacing","divider","noscroll","props","style","overflowX","Body","configureMetamaskListeners","cb","on","paramMapping","r","v","d","h","Publish","urlQuery","location","search","params","pair","decodeURIComponent","parseUrlQuery","this","bind","buttonInput","showManifestButtons","manifestHash","disablePublish","txPreview","getInputClass","loading","formFields","htmlFor","onChange","line","i","href","newTabProps","color","textDecoration","encodeURIComponent","whiteSpace","disabled","onClick","publish","src","metamaskIcon","alt","genericError","React","Component","mapStateToProps","createStructuredSelector","repoNames","selector","someFormInputIsInvalid","disable","field","manifestHashInput","mapDispatchToProps","validateRepoName","VALIDATE_REPO_NAME","connect","Boolean","hostname","match","ReactDOM","render","StrictMode","App","document","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.06ecaf96.chunk.js","sourcesContent":["import Web3 from \"web3\";\nimport { fullnodeHttpJsonRpc } from \"params\";\n\nfunction configureWeb3() {\n  if (process.env.REACT_APP_MOCK_DATA || process.env.TEST) return {};\n\n  return new Web3(fullnodeHttpJsonRpc);\n}\n\nexport default configureWeb3();\n","import web3 from \"./web3\";\nimport registryContract from \"contracts/registry.json\";\nimport repoContract from \"contracts/repository.json\";\n\n/**\n * Generates the transaction data necessary to publish the package.\n * It will check if the repository exists first:\n * - If it exists:\n * - If it does not exists:\n */\n\nexport default function generateTxWrap(kwargs) {\n  try {\n    return generatePublishTx(kwargs);\n  } catch (e) {\n    return { error: `Error generating tx: ${e.message}` };\n  }\n}\n\nfunction generatePublishTx({\n  ensName,\n  manifestIpfsHash,\n  version,\n  developerAddress,\n  registryAddress,\n  repoAddress,\n}) {\n  if (!manifestIpfsHash)\n    throw Error(`manifestIpfsHash must be defined: ${manifestIpfsHash}`);\n  // Compute tx data\n  const contentURI =\n    \"0x\" + Buffer.from(manifestIpfsHash, \"utf8\").toString(\"hex\");\n  // @param _contractAddress address for smart contract logic for version (if set to 0, it uses last versions' contractAddress)\n  const contractAddress = \"0x0000000000000000000000000000000000000000\";\n  const shortName = ensName.split(\".\")[0];\n\n  // Ensure that a valid registry exists\n  if (!registryAddress)\n    throw Error(\n      `There must exist a registry for DAppNode Package name ${ensName}`\n    );\n\n  // If repository exists, push new version to it\n  if (repoAddress) {\n    // newVersion(\n    //     uint16[3] _newSemanticVersion,\n    //     address _contractAddress,\n    //     bytes _contentURI\n    // )\n    const repo = new web3.eth.Contract(repoContract.abi, repoAddress);\n    const newVersionCall = repo.methods.newVersion(\n      version.split(\".\"), // uint16[3] _newSemanticVersion\n      contractAddress, // address _contractAddress\n      contentURI // bytes _contentURI\n    );\n    return {\n      To: repoAddress,\n      Value: 0,\n      Data: newVersionCall.encodeABI(),\n      \"Gas limit\": 300000,\n    };\n  }\n  // If repo does not exist, create a new repo and push version\n  else {\n    // A developer address can be provided by the option developerAddress.\n    // If it is not provided a prompt will ask for it\n\n    // newRepoWithVersion(\n    //     string _name,\n    //     address _dev,\n    //     uint16[3] _initialSemanticVersion,\n    //     address _contractAddress,\n    //     bytes _contentURI\n    // )\n    const registry = new web3.eth.Contract(\n      registryContract.abi,\n      registryAddress\n    );\n    const newRepoWithVersionCall = registry.methods.newRepoWithVersion(\n      shortName, // string _name\n      developerAddress, // address _dev\n      version.split(\".\"), // uint16[3] _initialSemanticVersion\n      contractAddress, // address _contractAddress\n      contentURI // bytes _contentURI\n    );\n    return {\n      To: registryAddress,\n      Value: 0,\n      Data: newRepoWithVersionCall.encodeABI(),\n      \"Gas limit\": 1100000,\n    };\n  }\n}\n","import registryContract from \"contracts/registry.json\";\nimport repoContract from \"contracts/repository.json\";\n\nexport default async function executePublishTx(\n  web3,\n  {\n    dnpName,\n    version,\n    manifestIpfsHash,\n    developerAddress,\n    registryAddress,\n    repoAddress,\n  }\n) {\n  if (!dnpName) throw Error(\"dnpName must be defined\");\n  if (!version) throw Error(\"version must be defined\");\n  if (!manifestIpfsHash) throw Error(\"manifestIpfsHash must be defined\");\n  if (!registryAddress) throw Error(\"registryAddress must be defined\");\n  if (!manifestIpfsHash && !developerAddress)\n    throw Error(\"developerAddress or repoAddress must be defined\");\n\n  // Compute tx data\n  const contentURI =\n    \"0x\" + Buffer.from(manifestIpfsHash, \"utf8\").toString(\"hex\");\n  // @param _contractAddress address for smart contract logic for version (if set to 0, it uses last versions' contractAddress)\n  const contractAddress = \"0x0000000000000000000000000000000000000000\";\n  const shortName = dnpName.split(\".\")[0];\n\n  const userAddress = await web3.eth.getAccounts().then((res) => res[0]);\n\n  // If repository exists, push new version to it\n  if (repoAddress) {\n    // newVersion(\n    //     uint16[3] _newSemanticVersion,\n    //     address _contractAddress,\n    //     bytes _contentURI\n    // )\n    const repo = new web3.eth.Contract(repoContract.abi, repoAddress);\n    const txHash = await repo.methods\n      .newVersion(\n        version.split(\".\"), // uint16[3] _newSemanticVersion\n        contractAddress, // address _contractAddress\n        contentURI // bytes _contentURI\n      )\n      .send({ from: userAddress, gas: 300000, value: 0 });\n    /* eslint-disable-next-line no-console */\n    console.log(\"got txHash\", txHash);\n  }\n  // If repo does not exist, create a new repo and push version\n  else {\n    // A developer address can be provided by the option developerAddress.\n    // If it is not provided a prompt will ask for it\n\n    // newRepoWithVersion(\n    //     string _name,\n    //     address _dev,\n    //     uint16[3] _initialSemanticVersion,\n    //     address _contractAddress,\n    //     bytes _contentURI\n    // )\n    const registry = new web3.eth.Contract(\n      registryContract.abi,\n      registryAddress\n    );\n    const txHash = await registry.methods\n      .newRepoWithVersion(\n        shortName, // string _name\n        developerAddress, // address _dev\n        version.split(\".\"), // uint16[3] _initialSemanticVersion\n        contractAddress, // address _contractAddress\n        contentURI // bytes _contentURI\n      )\n      .send({ from: userAddress, gas: 1100000, value: 0 });\n    /* eslint-disable-next-line no-console */\n    console.log(\"got txHash\", txHash);\n  }\n}\n","module.exports = \"data:image/png;base64,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\"","import { mountPoint } from \"./data\";\n\n/**\n * Generates the actionTypes object = {\n * This utility eases the addition of new actionTypes, and ensures a common format\n */\nexport default generateActionTypes(mountPoint, [\n  \"UPDATE_REGISTRY\",\n  \"UPDATE_REPO\",\n  \"FETCH_REGISTRY\",\n  \"VALIDATE_REPO_NAME\",\n  \"UPDATE_REPO_NAME\",\n  \"UPDATE_QUERY\",\n  \"UPDATE_QUERY_RESULT\",\n  \"CONNECT_METAMASK\",\n  \"PUBLISH\",\n  \"UPDATE_UI_MESSAGE\"\n]);\n\n/**\n * ### Todo: delete this util\n *\n * Utility to ease the addition of actionTypes\n *\n * @param {string} moduleId = 'moduleName', name of the module\n * @param {array} actionTypes = [\n *   \"UPDATE_DAPPNODE_IDENTITY\",\n *   \"PUSH_NOTIFICATION\",\n *   ...\n * ]\n * @returns {object} actionTypes object = {\n *   UPDATE_DAPPNODE_IDENTITY: \"moduleName/UPDATE_DAPPNODE_IDENTITY\",\n *   PUSH_NOTIFICATION: \"moduleName/PUSH_NOTIFICATION\",\n *   ...\n * }\n */\nfunction generateActionTypes(moduleId, actionTypes) {\n  const obj = {};\n  actionTypes.forEach(actionType => {\n    // prefixing each type with the module name helps preventing name collisions\n    obj[actionType] = moduleId + \"/\" + actionType;\n  });\n  return obj;\n}\n","// This will be used later in our root reducer and selectors\n\nexport const mountPoint = \"page-sdk\";\nexport const rootPath = \"/sdk\";\nexport const title = \"SDK\";\n\n// Subroutes\nexport const publishId = \"publish\";\n","// INSTALLER\nimport t from \"./actionTypes\";\n\n// Used in package root\n\nexport const updateRegistryFetching = (registryEns, fetching) => ({\n  type: t.UPDATE_REGISTRY,\n  registryEns,\n  data: { fetching }\n});\n\nexport const updateRegistry = (registryEns, data) => ({\n  type: t.UPDATE_REGISTRY,\n  registryEns,\n  data\n});\n\nexport const updateRepo = (registryEns, repoName, data) => ({\n  type: t.UPDATE_REPO,\n  registryEns,\n  repoName,\n  data\n});\n\nexport const validateRepoName = repoName => ({\n  type: t.VALIDATE_REPO_NAME,\n  repoName\n});\n\nexport const updateRepoName = (repoName, data) => ({\n  type: t.UPDATE_REPO_NAME,\n  repoName,\n  data\n});\n\nexport const updateQuery = (id, value) => ({\n  type: t.UPDATE_QUERY,\n  id,\n  value\n});\n\nexport const updateQueryResult = (id, data) => ({\n  type: t.UPDATE_QUERY_RESULT,\n  id,\n  data\n});\n\nexport const fetchRegistry = registryEns => ({\n  type: t.FETCH_REGISTRY,\n  registryEns\n});\n\nexport const connectMetamask = () => ({\n  type: t.CONNECT_METAMASK\n});\n\nexport const publish = () => ({\n  type: t.PUBLISH\n});\n\nexport const updateButtonMessage = message => ({\n  type: t.UPDATE_UI_MESSAGE,\n  uiId: \"publishButton\",\n  message\n});\n\nexport const updateGenericError = message => ({\n  type: t.UPDATE_QUERY_RESULT,\n  id: \"genericError\",\n  data: message\n});\n","// @ts-ignore // No type definitions for \"is-ipfs\"\nimport isIPFS from \"is-ipfs\";\n\nfunction isMultihash(hash: string) {\n  return isIPFS.cid(hash);\n}\n\n/**\n * Checks if the given string is a valid IPFS CID or path\n *\n * isIPFS.cid('QmYjtig7VJQ6XsnUjqqJvj7QaMcCAwtrgNdahSiFofrE7o') // true (CIDv0)\n * isIPFS.cid('zdj7WWeQ43G6JJvLWQWZpyHuAMq6uYWRjkBXFad11vE2LHhQ7') // true (CIDv1)\n * isIPFS.cid('noop') // false\n *\n * @param hash\n */\nexport default function isIpfsHash(hash: string): boolean {\n  if (!hash || typeof hash !== \"string\") return false;\n  // Correct hash prefix\n  if (hash.includes(\"ipfs/\")) {\n    hash = hash.split(\"ipfs/\")[1];\n  }\n  hash.replace(\"/\", \"\");\n  // Make sure hash if valid\n  return isMultihash(hash);\n}\n","/**\n * Safe version of String.toLowerCase\n * @param {string} s\n * @returns {string}\n */\nexport const toLowercase = (s: string): string => {\n  if (!s || typeof s !== \"string\") return \"\";\n  return s.toLowerCase();\n};\n\n/**\n * Capitalizes a string\n * @param {string} string = \"hello world\"\n * @returns {string} \"Hello world\"\n */\nexport const capitalize = (s: string): string => {\n  if (!s || typeof s !== \"string\") return s;\n  return s.charAt(0).toUpperCase() + s.slice(1);\n};\n\n/**\n * Checks if string includes content.\n * - If string or content are undefined, returns false\n * - Does the check in lowerCase\n * @param {string} s = \"HeLLo\"\n * @param {string} content = \"lo\"\n * @returns {bool} = true\n */\nexport const stringIncludes = (s: string, content: string): boolean => {\n  if (!s || typeof s !== \"string\") return false;\n  if (!content || typeof content !== \"string\") return false;\n  return s.toLowerCase().includes(content.toLowerCase());\n};\n\n/**\n * Checks if string endsWith content.\n * - If string or content are undefined, returns false\n * - Does the check in lowerCase\n * @param {string} s = \"HeLLo\"\n * @param {string} content = \"lo\"\n * @returns {bool} = true\n */\nexport const stringEndsWith = (s: string, content: string): boolean => {\n  if (!s || typeof s !== \"string\") return false;\n  if (!content || typeof content !== \"string\") return false;\n  return s.toLowerCase().endsWith(content.toLowerCase());\n};\n\n/**\n * Split string by separator.\n * - If string or separator are undefined, returns an empty array\n * @param {string} s = \"vpn.eth\"\n * @param {string|object} separator = \".\", /\\.(.+)/\n * @returns {array} [\"vpn\", \"eth\"]\n */\nexport const stringSplit = (\n  s: string,\n  separator: string | RegExp\n): string[] => {\n  if (!s || typeof s !== \"string\") return [\"\"];\n  if (!separator) return [\"\"];\n  return s.split(separator);\n};\n\n/**\n * Converts constant case \"SOME_BAR\", to a sentence \"Some bar\"\n * @param {string} s\n */\nexport const toSentence = (s: string): string => {\n  if (!s || typeof s !== \"string\") return s;\n  return capitalize(s.replace(new RegExp(\"_\", \"g\"), \" \").toLowerCase());\n};\n","// SDK\nimport semver from \"semver\";\nimport web3Utils from \"web3-utils\";\nimport isIpfsHash from \"utils/isIpfsHash\";\nimport { stringIncludes } from \"utils/strings\";\nimport generatePublishTx from \"./sagaUtils/generatePublishTx\";\n\n// #### EXTERNAL\n\n// #### INTERNAL\n\nconst local = (state) => state;\nexport const registries = (state) => local(state).registries;\nexport const repoName = (state) => local(state).repoName;\nexport const query = (state) => local(state).query;\nexport const queryResult = (state) => local(state).queryResult;\nexport const getQuery = (state) => local(state).query;\nexport const getQueryResult = (state) => local(state).queryResult;\n\nexport const getGenericError = (state) =>\n  (getQueryResult(state) || {})[\"genericError\"];\n\nexport const getShowManifestButtons = (state) => {\n  const manifestHashInput = getManifestHashInput(state);\n  const manifestIpfsHash = getQuery(state).manifestIpfsHash;\n  return !manifestHashInput.error && manifestHashInput.success\n    ? manifestIpfsHash\n    : null;\n};\n\nexport const getDisablePublish = (state) => {\n  const someFormInputIsInvalid = getInputFields(state)\n    .filter(({ hide }) => !hide)\n    .reduce(\n      (disable, field) => disable || field.error || !field.success,\n      false\n    );\n  const { addressNotAllowed } = getButtonInput(state) || {};\n  return someFormInputIsInvalid || addressNotAllowed;\n};\n\nexport const getInputFields = (state) => [\n  {\n    id: \"dnpName\",\n    name: \"DAppNode Package name\",\n    placeholder: \"full ENS name\",\n    help:\n      \"Full ENS name of the DAppNode Package to update, i.e. timeapp.public.dappnode.eth\",\n    ...getDnpNameInput(state),\n  },\n  {\n    id: \"developerAddress\",\n    name: \"Developer address\",\n    placeholder: \"Ethereum address\",\n    help:\n      \"Ethereum address of the developer address that will control this repo\",\n    ...getDeveloperAddressInput(state),\n  },\n  {\n    id: \"version\",\n    name: \"Next version\",\n    placeholder: \"Semantic version\",\n    help: \"Semantic version about to be published, i.e. 0.1.7\",\n    ...getVersionInput(state),\n  },\n  {\n    id: \"manifestIpfsHash\",\n    name: \"Manifest hash\",\n    placeholder: \"IPFS multihash\",\n    help:\n      \"Multihash content address of the manifest. Must be in the format /ipfs/[multihash], i.e. /ipfs/QmVeaz5kR55nAiGjYpXpUAJpWvf6net4MbGFNjBfMTS8xS\",\n    ...getManifestHashInput(state),\n  },\n];\n\n// Errors + success rules\n\nexport const getQueryResultRepoInfo = (state) => {\n  const dnpName = getQuery(state).dnpName;\n  const repoInfo = getQueryResult(state).repoInfo;\n  // If the dnpName store in the query result is not the same as the query,\n  // it means it's still loading\n  if (!(repoInfo || {}).value || repoInfo.value !== dnpName) return null;\n  else return repoInfo;\n};\n\nexport const getQueryResultMetamaskInfo = (state) =>\n  getQueryResult(state).metamaskInfo;\nexport const getQueryResultAllowedAddress = (state) =>\n  getQueryResult(state).allowedAddress;\nexport const getQueryResultCall = (state) => getQueryResult(state).call;\nexport const getQueryResultManifest = (state) => getQueryResult(state).manifest;\n\n// ========\n// DNP NAME\n// ========\n\nfunction getDnpNameInput(state) {\n  const dnpName = getQuery(state).dnpName;\n  const repoInfo = getQueryResultRepoInfo(state);\n  const error = [],\n    success = [];\n  // Validation that don't require external calls\n  if (dnpName && !stringIncludes(dnpName, \".\"))\n    error.push(`\"${dnpName}\" is not a valid ENS domain`);\n\n  // Validations that require external calls\n  if (dnpName && repoInfo) {\n    const { registryAddress, repoAddress, latestVersion } = repoInfo;\n    if (registryAddress) success.push(`Registry found: ${registryAddress}`);\n    else error.push(`\"${dnpName}\" does not have a valid registry`);\n    if (repoAddress) success.push(`Repo already deployed at: ${repoAddress}`);\n    else\n      success.push(\n        `A new repo will be deployed for the DAppNode Package \"${dnpName}\"`\n      );\n    if (latestVersion) success.push(`Latest version: ${latestVersion}`);\n  }\n  return cleanArrays({ error, success });\n}\n\n// =======\n// VERSION\n// =======\n\nconst isValidBump = (prevVersion, nextVersion) => {\n  for (const type of [\"patch\", \"minor\", \"major\"]) {\n    if (semver.inc(prevVersion, type) === nextVersion) return type;\n  }\n};\n\nconst getValidBumps = (prevVersion) =>\n  [\"patch\", \"minor\", \"major\"]\n    .map((type) => semver.inc(prevVersion, type))\n    .join(\", \");\n\nfunction getVersionInput(state) {\n  const version = getQuery(state).version;\n  const repoInfo = getQueryResultRepoInfo(state);\n  const latestVersion = (repoInfo || {}).latestVersion;\n  // Compute error messages + success message\n  const error = [],\n    success = [];\n  // Validation that don't require external calls\n  if (version) {\n    if (semver.valid(version)) success.push(`Valid version`);\n    else error.push(\"Sematic version must be valid, i.e. 0.1.7\");\n  }\n  // Validations that require external calls\n  if (semver.valid(version) && latestVersion) {\n    const bumpType = isValidBump(latestVersion, version);\n    if (bumpType) success.push(`Valid bump of type \"${bumpType}\"`);\n    else\n      error.push(\n        `Next version is not a valid bump. Must be ${getValidBumps(\n          latestVersion\n        )}`\n      );\n  }\n  return cleanArrays({ error, success });\n}\n\n// =================\n// DEVELOPER ADDRESS\n// =================\n\nfunction getDeveloperAddressInput(state) {\n  const developerAddress = getQuery(state).developerAddress;\n  const repoInfo = getQueryResultRepoInfo(state);\n  const { registryAddress, repoAddress } = repoInfo || {};\n  // Compute error messages\n  const error = [],\n    success = [];\n  if (developerAddress) {\n    if (web3Utils.isAddress(developerAddress)) success.push(`Valid address`);\n    else error.push(\"Must be a valid ethereum address\");\n  }\n  return cleanArrays({ error, success, hide: !registryAddress || repoAddress });\n}\n\n// =============\n// MANIFEST HASH\n// =============\n\nfunction getManifestHashInput(state) {\n  const manifestIpfsHash = getQuery(state).manifestIpfsHash;\n  const version = getQuery(state).version;\n  const dnpName = getQuery(state).dnpName;\n  const manifestResult = getQueryResultManifest(state);\n  // Compute error messages\n  const error = [],\n    success = [];\n  if (manifestIpfsHash) {\n    if (isIpfsHash(manifestIpfsHash)) success.push(`Valid ipfs hash`);\n    else error.push(\"Manifest hash must be a valid IPFS hash\");\n  }\n  const { manifest } = manifestResult || {};\n  if (\n    manifestResult &&\n    manifestIpfsHash &&\n    manifestIpfsHash === manifestResult.hash &&\n    manifest &&\n    manifest.name &&\n    manifest.version &&\n    version &&\n    dnpName\n  ) {\n    if (manifest.name === dnpName && manifest.version === version)\n      success.push(`Manifest successfully verified`);\n    else\n      error.push(\n        `Manifest verification failed. This manifest is for ${manifest.name} @ ${manifest.version}`\n      );\n  }\n  return cleanArrays({ error, success });\n}\n\n// =============\n// SUBMIT BUTTON\n// =============\n\nexport function getButtonInput(state) {\n  const repoInfo = getQueryResultRepoInfo(state);\n  const metamaskInfo = getQueryResultMetamaskInfo(state);\n  const allowedAddress = getQueryResultAllowedAddress(state);\n  const callResult = getQueryResultCall(state);\n  const ethereum = window.ethereum;\n\n  const error = [],\n    success = [];\n  if (metamaskInfo) {\n    let networkId = metamaskInfo.networkId || (ethereum || {}).networkVersion;\n    // Validation that don't require external calls\n    if (networkId && String(networkId) !== \"1\") {\n      error.push(\n        `Transactions must be published on mainnet. Please select \"Main Network\" on the metamask extension`\n      );\n    }\n  }\n\n  const connected = (metamaskInfo || {}).connected;\n  let addressNotAllowed;\n\n  // Validations that require external calls\n  const userAddress = (ethereum || {}).selectedAddress;\n  if (\n    repoInfo &&\n    allowedAddress &&\n    repoInfo.repoAddress &&\n    userAddress &&\n    stringIncludes(repoInfo.repoAddress, allowedAddress.repoAddress) &&\n    stringIncludes(userAddress, allowedAddress.userAddress)\n  ) {\n    if (allowedAddress.isAllowed) {\n      success.push(`Selected address ${userAddress} is allowed to publish`);\n    } else {\n      error.push(`Selected address ${userAddress} is not allowed to publish`);\n      addressNotAllowed = true;\n    }\n  }\n\n  if (callResult) {\n    if (callResult.type === \"success\") success.push(callResult.message);\n    if (callResult.type === \"error\") error.push(callResult.message);\n  }\n\n  return cleanArrays({ error, success, connected, addressNotAllowed });\n}\n\n// ===================\n// TRANSACTION PREVIEW\n// ===================\n\nexport function getTransactionPreview(state) {\n  const query = getQuery(state);\n  const repoInfo = getQueryResultRepoInfo(state);\n  const { dnpName, developerAddress, version, manifestIpfsHash } = query || {};\n  const { registryAddress, repoAddress } = repoInfo || {};\n  if (\n    dnpName &&\n    version &&\n    manifestIpfsHash &&\n    registryAddress &&\n    (repoAddress || developerAddress)\n  )\n    return generatePublishTx({\n      ensName: dnpName,\n      manifestIpfsHash,\n      version,\n      developerAddress,\n      registryAddress,\n      repoAddress,\n    });\n  else return null;\n}\n\n// Utils\n\nfunction cleanArrays(obj) {\n  for (const key of Object.keys(obj)) {\n    if (Array.isArray(obj[key]) && !obj[key].length) {\n      obj[key] = null;\n    }\n  }\n  return obj;\n}\n","import registryContract from \"contracts/registry.json\";\nimport web3 from \"./web3\";\nimport web3Utils from \"web3-utils\";\nimport { stringIncludes } from \"utils/strings\";\n\n/**\n * Fetches all repos from a registry.\n * This call may take a long while (10-30 seconds)\n *\n * @param {string} registryAddress = '0x266bfdb2124a68beb6769dc887bd655f78778923'\n * @returns {object} of repos: {\n *   timenode: {\n *     id: \"0x6a5699a502e5914239605cde5bd114545c56cef63bbac3a3f5783844226a99a9\"\n *     name: \"timenode\"\n *     repoAddr: \"0x2ee525f1ae6c822D4205A915586616524A9DaC1E\"\n *     timestamp: 1543338354\n *   },\n *   ...\n * }\n */\nasync function getRegistry(registryAddress) {\n  if (!registryAddress) throw Error(\"registryAddress must be defined\");\n  if (!web3Utils.isAddress(registryAddress))\n    throw Error(`registryAddress must be an address: ${registryAddress}`);\n\n  const registry = new web3.eth.Contract(registryContract.abi, registryAddress);\n  // Event definition\n  //   topic: \"0x526d4ccf8c3d7b6f0b6d4cc0de526d515c87d1ea3bd264ace0b5c2e70d1b2208\"\n  //   event NewRepo(bytes32 id, string name, address repo);\n  // Event usage https://github.com/aragon/aragonOS/blob/da862e2c8d2666f8a15be74f4d401659e3e1b497/contracts/apm/APMRegistry.sol#L97\n  //   bytes32 node = registrar.createNameAndPoint(keccak256(abi.encodePacked(_name)), repo);\n  //   emit NewRepo(node, _name, repo);\n\n  const newRepoEvents = await registry\n    .getPastEvents(\"NewRepo\", {\n      fromBlock: registryContract.deployBlock,\n    })\n    .then(removeDuplicatedRepos);\n  return newRepoEvents\n    .filter((event) => {\n      // Ignore faulty deploy of telegram repo\n      const name = event.returnValues.name || \"\";\n      if (\n        stringIncludes(\n          registryAddress,\n          \"0x266bfdb2124a68beb6769dc887bd655f78778923\"\n        ) &&\n        stringIncludes(name, \".\")\n      )\n        return false;\n      // ignore apm-registry apm-enssub apm-repo\n      if (name.startsWith(\"apm-\")) return false;\n      return true;\n    })\n    .map((newRepoEvent) => {\n      // id: '0xd7ec73ef33cd0720e49cbc4bfb1a912840535bee540dcf01d1cc4caae0129631',\n      // name: 'livepeer',\n      // repo: '0xf655173FAfb85f9f2943b2F2518146a4c149c70b',\n      const { id, name, repo: address } = newRepoEvent.returnValues;\n      return {\n        id,\n        name,\n        address,\n        blockNumber: newRepoEvent.blockNumber,\n      };\n    })\n    .reduce((obj, item) => {\n      obj[item.name] = item;\n      return obj;\n    }, {});\n}\n\n// Utility\n\n// There has been issues during the deploy of some repos.\n// This function ignores repos that have the same id assuming the latter repo is the good one\nfunction removeDuplicatedRepos(repoEvents) {\n  // Deal with duplicated repos\n  // If two events have the same id, the latest will be pinned\n  const eventsObj = {};\n  for (const event of repoEvents) {\n    const { id } = event.returnValues;\n    if (!eventsObj[id] || event.blockNumber > eventsObj[id].blockNumber) {\n      eventsObj[id] = event;\n    }\n  }\n  return Object.values(eventsObj);\n}\n\nexport default getRegistry;\n","import web3 from \"./web3\";\nimport getBlockTimestamp from \"./getBlockTimestamp\";\nimport repoContract from \"contracts/repository.json\";\n\nconst options = {\n  year: \"numeric\",\n  month: \"short\",\n  day: \"numeric\"\n};\n\nfunction getDate(blockNumber) {\n  return getBlockTimestamp(blockNumber).then(timestamp =>\n    new Intl.DateTimeFormat(\"en-US\", options).format(timestamp * 1000)\n  );\n}\n\nfunction getContentUri(repo, version) {\n  return repo.methods\n    .getBySemanticVersion(version)\n    .call()\n    .then(result => web3.utils.hexToAscii(result.contentURI))\n    .catch(e =>\n      e.message === \"Couldn't decode uint16 from ABI: 0x\"\n        ? \"NOT_VALID_VERSION\"\n        : e.message\n    );\n}\n\n// txHash = 0xc2589085830a93086ae9e133b613005a1e3d1b6aaa863631eec606d5e3d6b028\nfunction getSender(txHash) {\n  return web3.eth.getTransaction(txHash).then(txObj => txObj.from);\n}\n\n// function addPackage({ id, name, repoAddr }) {\n//   logs.info(`Adding ${name}, repoAddr: ${repoAddr}, id: ${id}`);\nasync function getRepo({ blockNumber, address }) {\n  // event NewVersion(uint256 versionId, uint16[3] semanticVersion);\n  const repo = new web3.eth.Contract(repoContract.abi, address);\n  const newVersionEvents = await repo.getPastEvents(\"NewVersion\", {\n    fromBlock: String(blockNumber)\n  });\n  const versions = await Promise.all(\n    newVersionEvents.reverse().map(async newVersionEvent => {\n      const { semanticVersion } = newVersionEvent.returnValues;\n      const [date, sender, contentUri] = await Promise.all([\n        getDate(newVersionEvent.blockNumber),\n        getSender(newVersionEvent.transactionHash),\n        getContentUri(repo, semanticVersion)\n      ]);\n      return {\n        version: semanticVersion.join(\".\"),\n        blockNumber: newVersionEvent.blockNumber,\n        date,\n        sender,\n        contentUri\n      };\n    })\n  );\n  return {\n    date: await getDate(blockNumber),\n    versions: versions.reduce((obj, item) => {\n      obj[item.version] = item;\n      return obj;\n    }, {})\n  };\n}\n\nexport default getRepo;\n","import web3 from \"./web3\";\n\nexport default function getBlockTimestamp(blockNumber) {\n  return web3.eth\n    .getBlock(blockNumber)\n    .catch(e =>\n      console.error(\n        `Error getting timestamp for blockNumber ${blockNumber} ${e.stack}`\n      )\n    )\n    .then(block => parseInt((block || {}).timestamp || 0, 10));\n}\n","import web3 from \"./web3\";\nimport Ens from \"ethereum-ens\";\n\nfunction configureEns() {\n  if (process.env.REACT_APP_MOCK_DATA || process.env.TEST) return {};\n\n  const _provider = web3.currentProvider;\n  // Correct incompatibility between modules\n  _provider.sendAsync = _provider.sendAsync || _provider.send;\n  return new Ens(_provider);\n}\n\nexport default configureEns();\n","import ens from \"./ens\";\nimport { stringIncludes } from \"utils/strings\";\n\n// Ens throws if a node is not found\n//\n// ens.resolver('admin.dnp.dappnode.eth').addr()\n// ==> 0xee66c4765696c922078e8670aa9e6d4f6ffcc455\n// ens.resolver('fake.dnp.dappnode.eth').addr()\n// ==> Unhandled rejection Error: ENS name not found\n//\n// Change behaviour to return null if not found\nexport default async function resolveEns(ensName) {\n  try {\n    return await ens.resolver(ensName).addr();\n  } catch (e) {\n    if (stringIncludes((e || {}).message, \"not found\")) return null;\n    else throw e;\n  }\n}\n","import web3 from \"./web3\";\nimport repo from \"contracts/repository.json\";\n\n/**\n * Get the lastest version of an APM repo contract for an ENS domain.\n *\n * @param {string} ensName: \"admin.dnp.dappnode.eth\"\n * @returns {string} latest semver version = '0.1.0'\n */\nasync function getLatestVersion(repoAddress) {\n  const repoInstance = new web3.eth.Contract(repo.abi, repoAddress);\n  return await repoInstance.methods\n    .getLatest()\n    .call()\n    .then(res => res.semanticVersion.join(\".\"))\n    .catch(e => {\n      // Rename error for user comprehension\n      e.message = `Error getting latest version of ${repoAddress}: ${e.message}`;\n      throw e;\n    });\n}\n\nasync function isAllowed(repoAddress, address) {\n  const repoInstance = new web3.eth.Contract(repo.abi, repoAddress);\n  return await repoInstance.methods\n    .canPerform(\n      address,\n      \"0x0000000000000000000000000000000000000000000000000000000000000001\",\n      []\n    )\n    .call()\n    .catch(e => {\n      // Rename error for user comprehension\n      e.message = `Error checking if account ${address} is allowed at ${repoAddress}: ${e.message}`;\n      throw e;\n    });\n}\n\nexport default {\n  getLatestVersion,\n  isAllowed\n};\n","import Web3 from \"web3\";\n\nexport default async function connectToMetamask() {\n  // Modern dapp browsers...\n  if (window.ethereum) {\n    // Request account access if needed\n    await window.ethereum.enable();\n    // Acccounts now exposed\n    return new Web3(window.ethereum);\n    // web3.eth.sendTransaction({\n    //   /* ... */\n    // });\n  }\n  // Legacy dapp browsers...\n  else if (window.web3) {\n    return new Web3(window.web3.currentProvider);\n  }\n  // Non-dapp browsers...\n  else {\n    throw Error(\"Non-Ethereum browser detected. Please, install MetaMask\");\n  }\n}\n","import {\n  call,\n  put,\n  all,\n  select,\n  take,\n  delay,\n  takeEvery,\n} from \"redux-saga/effects\";\nimport t from \"./actionTypes\";\nimport * as a from \"./actions\";\nimport * as s from \"./selectors\";\nimport getRegistry from \"./sagaUtils/getRegistry\";\nimport getRepo from \"./sagaUtils/getRepo\";\nimport resolveEns from \"./sagaUtils/resolveEns\";\nimport apm from \"./sagaUtils/apm\";\nimport connectToMetamask from \"./sagaUtils/connectToMetamask\";\nimport executePublishTx from \"./sagaUtils/executePublishTx\";\nimport { ipfsGateway } from \"params\"\n\nasync function fetchManifestFromIpfs(hash) {\n  try {\n    return await fetch(`${ipfsGateway}${hash}/dappnode_package.json`).then(res => res.json())\n  } catch (e) {\n    return await fetch(`${ipfsGateway}${hash}`).then(res => res.json())\n  }\n}\n\n// getRegistry(\"dnp.dappnode.eth\");\n\n/***************************** Subroutines ************************************/\n\nfunction* connectMetamask() {\n  try {\n    yield put(a.updateGenericError(null));\n    /* eslint-disable-next-line no-console */\n    console.log(\"Connecting to metamask...\");\n    const web3 = yield call(connectToMetamask);\n    const networkId = yield call(web3.eth.net.getId);\n    const accounts = yield call(web3.eth.getAccounts);\n    const userAddress = accounts[0];\n    yield put(\n      a.updateQueryResult(\"metamaskInfo\", {\n        userAddress,\n        networkId,\n        connected: true,\n      })\n    );\n    yield put(a.updateQuery(\"userAccount\", userAddress));\n    while (true) {\n      try {\n        yield take(t.PUBLISH);\n        const query = yield select(s.getQuery);\n        const repoInfo = yield select(s.getQueryResultRepoInfo);\n        const txHash = yield call(executePublishTx, web3, {\n          ...query,\n          ...repoInfo,\n        });\n        a.updateQueryResult(\"call\", {\n          type: \"success\",\n          message: `Tx successfully executed. Tx hash: ${txHash}`,\n        });\n      } catch (e) {\n        console.error(`Error executing transaction: ${e.stack}`);\n        yield put(\n          a.updateQueryResult(\"call\", {\n            type: \"error\",\n            message: `Error executing transaction: ${e.message}`,\n          })\n        );\n      }\n      yield call(delay, 500);\n    }\n  } catch (e) {\n    console.error(\"Error connecting to metamask: \", e.stack);\n    yield put(\n      a.updateGenericError(`Error connecting to metamask: ${e.message}`)\n    );\n  }\n}\n\nfunction getRegistryFromRepo(repoName = \"\") {\n  return (repoName || \"\").split(\".\").slice(1).join(\".\");\n}\n\n// Check if the registry and repo exist\nasync function resolveRepoName(repoName) {\n  const registryName = getRegistryFromRepo(repoName);\n  const [repoAddress, registryAddress] = await Promise.all(\n    [repoName, registryName].map(resolveEns)\n  );\n  return { repoAddress, registryAddress };\n}\n\n// async function generatePublishTx({\n//   ensName,\n//   manifestIpfsPath,\n//   version,\n//   developerAddress\n// }) {}\n\nfunction* fetchRegistry({ registryEns }) {\n  try {\n    if (!registryEns) throw Error(\"registryEns must be defined\");\n    yield put(\n      a.updateRegistry(registryEns, { name: registryEns, fetching: true })\n    );\n    const registryAddress = yield call(resolveEns, registryEns);\n    yield put(a.updateRegistry(registryEns, { address: registryAddress }));\n    const repos = yield call(getRegistry, registryAddress);\n    yield put(a.updateRegistry(registryEns, { repos, fetching: false }));\n    yield all(\n      Object.values(repos).map((repo) =>\n        call(function* () {\n          yield put(a.updateRepo(registryEns, repo.name, { fetching: true }));\n          const repoData = yield call(getRepo, repo);\n          yield put(\n            a.updateRepo(registryEns, repo.name, {\n              ...repoData,\n              fetching: false,\n            })\n          );\n        })\n      )\n    );\n  } catch (e) {\n    console.error(`Error fetching registry \"${registryEns}\": ${e.stack}`);\n  }\n}\n\nconst inputHanlders = {\n  dnpName: function* onUpdateQueryDnpName({ id, value }) {\n    try {\n      const { repoAddress, registryAddress } = yield call(\n        resolveRepoName,\n        value\n      );\n      yield put(\n        a.updateQueryResult(\"repoInfo\", { value, repoAddress, registryAddress })\n      );\n      if (repoAddress) {\n        const latestVersion = yield call(apm.getLatestVersion, repoAddress);\n        yield put(a.updateQueryResult(\"repoInfo\", { latestVersion }));\n      } else if (registryAddress) {\n        yield put(a.updateQueryResult(\"repoInfo\", { latestVersion: \"0.0.0\" }));\n      }\n      const userAddress = (window.ethereum || {}).selectedAddress;\n      if (repoAddress && userAddress) {\n        const isAllowed = yield call(apm.isAllowed, repoAddress, userAddress);\n        yield put(\n          a.updateQueryResult(\"allowedAddress\", {\n            userAddress,\n            repoAddress,\n            isAllowed,\n          })\n        );\n      }\n    } catch (e) {\n      console.error(`Error on update query for ${id} = ${value}: ${e.stack}`);\n    }\n  },\n  userAddress: function* onUpdateQueryUserAddress({ id, value }) {\n    try {\n      const repoInfo = yield select(s.getQueryResultRepoInfo);\n      const repoAddress = (repoInfo || {}).repoAddress;\n      const userAddress = value;\n      if (repoAddress && userAddress) {\n        const isAllowed = yield call(apm.isAllowed, repoAddress, userAddress);\n        yield put(\n          a.updateQueryResult(\"allowedAddress\", {\n            userAddress,\n            repoAddress,\n            isAllowed,\n          })\n        );\n      }\n    } catch (e) {\n      console.error(`Error on update query for ${id} = ${value}: ${e.stack}`);\n    }\n  },\n  manifestIpfsHash: function* onUpdateQueryManifestIpfsHash({ id, value }) {\n    try {\n      const ipfsHash = value;\n      const manifest = yield call(fetchManifestFromIpfs, ipfsHash);\n      yield put(a.updateQueryResult(\"manifest\", { hash: value, manifest }));\n    } catch (e) {\n      console.error(`Error on update query for ${id} = ${value}: ${e.stack}`);\n    }\n  },\n};\n\nconst getId = (id) => `${t.UPDATE_QUERY}_${id}`;\nfunction* onUpdateQuery({ id, value }) {\n  try {\n    yield put({ type: getId(id), id, value });\n  } catch (e) {\n    console.error(`Error on update query for ${id} = ${value}: ${e.stack}`);\n  }\n}\n\n// Update query dedicated throttling PER ID\n\n/******************************* Watchers *************************************/\n\n// Each saga is mapped with its actionType using takeEvery\n// takeEvery(actionType, watchers[actionType])\nconst watchers = [\n  [t.FETCH_REGISTRY, fetchRegistry],\n  [t.UPDATE_QUERY, onUpdateQuery],\n  ...Object.keys(inputHanlders).map((id) => [getId(id), inputHanlders[id]]),\n  [t.CONNECT_METAMASK, connectMetamask],\n];\n\nexport default function* rootSingleSaga() {\n  yield all(\n    watchers.map(([actionType, handler]) => {\n      return takeEvery(actionType, handler);\n    })\n  );\n}\n","//  PACKAGES\nimport t from \"./actionTypes\";\nimport merge from \"deepmerge\";\n\nconst initialState = {\n  registries: {},\n  repoName: {},\n  query: {},\n  queryResult: {},\n  uiMessage: {}\n};\n\nexport default function(state = initialState, action) {\n  switch (action.type) {\n    case t.UPDATE_REGISTRY:\n      return merge(state, {\n        registries: {\n          [action.registryEns]: action.data\n        }\n      });\n    case t.UPDATE_REPO:\n      return merge(state, {\n        registries: {\n          [action.registryEns]: {\n            repos: {\n              [action.repoName]: action.data\n            }\n          }\n        }\n      });\n    case t.UPDATE_REPO_NAME:\n      return merge(state, {\n        repoName: {\n          [action.repoName]: action.data\n        }\n      });\n    case t.UPDATE_QUERY:\n      return merge(state, {\n        query: {\n          [action.id]: action.value\n        }\n      });\n    case t.UPDATE_QUERY_RESULT:\n      return merge(state, {\n        queryResult: {\n          [action.id]: action.data\n        }\n      });\n    case t.UPDATE_UI_MESSAGE:\n      return merge(state, {\n        uiMessage: {\n          [action.uiId]: action.message\n        }\n      });\n    default:\n      return state;\n  }\n}\n","import { createStore, applyMiddleware } from \"redux\";\nimport createSagaMiddleware from \"redux-saga\";\n\n// App modules\nimport rootSaga from \"./sdk/sagas\";\nimport rootReducer from \"./sdk/reducer\";\n\n// create the saga middleware\nconst sagaMiddleware = createSagaMiddleware();\n\nconst middlewares = [sagaMiddleware];\n\nconst store = createStore(\n  rootReducer as any, // new root reducer with router state,\n  applyMiddleware(...middlewares)\n);\n\n// ##### DEV\n// @ts-ignore\nwindow.dispach = store.dispatch;\n// @ts-ignore\nwindow.store = store;\n\nexport default store;\n\n// Run the saga\nsagaMiddleware.run(rootSaga);\n","// Props to be passed to a JSX <a> element to open a new tab\n// The purpose of this utility is to centralize this props.\n// To disable the newTab openning for certain <a> from the whole project, edit this file\n//\n// It converts:\n//   <a href={url} rel=\"noopener noreferrer\" target=\"_blank\">\n// Into:\n//   <a href={url} {...newTabProps}>\n\nexport default { rel: \"noopener noreferrer\", target: \"_blank\" };\n","import React from \"react\";\n\ninterface TitleProps {\n  title: string;\n  subtitle?: string;\n}\n\nconst Title: React.FunctionComponent<TitleProps> = ({\n  title,\n  subtitle,\n  children,\n}) => {\n  if (children) return <div className=\"section-title\">{children}</div>;\n  if (subtitle)\n    return (\n      <div className=\"section-title\">\n        <span className=\"pre-title\">{title} </span>\n        {subtitle}\n      </div>\n    );\n  return <div className=\"section-title\">{title}</div>;\n};\n\nexport default Title;\n","import React from \"react\";\n\nconst SubTitle: React.FunctionComponent<{ className?: string }> = ({\n  children,\n  className,\n}) => <div className={`section-subtitle ${className || \"\"}`}>{children}</div>;\n\nexport default SubTitle;\n","type CssClass =\n  | { [className: string]: string | undefined | null | boolean }\n  | string\n  | undefined\n  | null;\n\n/**\n *\n * @param cssClassObj\n */\nexport function joinCssClass(...args: CssClass[]): string {\n  return args\n    .reduce((classNames, arg) => {\n      if (typeof arg === \"string\") classNames.push(arg);\n      if (typeof arg === \"object\")\n        for (const [key, val] of Object.entries(arg || {}))\n          if (val) classNames.push(key);\n      return classNames;\n    }, [] as string[])\n    .join(\" \");\n}\n","import React from \"react\";\nimport BootstrapCard from \"react-bootstrap/Card\";\nimport { joinCssClass } from \"../utils/css\";\n\nconst shadowStyle = { boxShadow: \"1px 1px 15px 0 rgba(0, 0, 0, 0.07)\" };\n\ninterface CardProps {\n  shadow?: boolean;\n  spacing?: boolean;\n  divider?: boolean;\n  noscroll?: boolean;\n}\n\n/**\n * [NOTE] style is injected to the card-body div via ...props\n */\nconst Card: React.FunctionComponent<\n  CardProps & React.HTMLAttributes<HTMLDivElement>\n> = ({\n  children,\n  className = \"\",\n  shadow,\n  spacing,\n  divider,\n  noscroll,\n  ...props\n}) => (\n  <BootstrapCard\n    style={{\n      overflowX: noscroll ? \"visible\" : \"auto\",\n      ...(shadow ? shadowStyle : {}),\n    }}\n  >\n    <BootstrapCard.Body\n      className={joinCssClass({\n        spacing,\n        divider,\n        noscroll,\n        [className]: className,\n      })}\n      {...props}\n    >\n      {children}\n    </BootstrapCard.Body>\n  </BootstrapCard>\n);\n\nexport default Card;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\nimport { createStructuredSelector } from \"reselect\";\n// This page\nimport * as selector from \"./sdk/selectors\";\nimport {\n  validateRepoName,\n  updateQuery,\n  connectMetamask,\n  publish,\n} from \"./sdk/actions\";\n// Imgs\nimport metamaskIcon from \"./img/metamask-white.png\";\n// Utils\nimport { parseUrlQuery } from \"./utils/urlQuery\";\nimport newTabProps from \"./utils/newTabProps\";\n// Components\nimport Title from \"./components/Title\";\nimport SubTitle from \"./components/SubTitle\";\nimport Card from \"./components/Card\";\n\nconst ipfsGateway = \"http://my.ipfs.dnp.dappnode.eth:8080/ipfs/\";\n\n// Necessary code to refresh the userAddress\n// when user interacts with the metamask extension\nlet configureMetamaskListeners = (cb) => {\n  if (!window.ethereum) return;\n  window.ethereum.on(\"accountsChanged\", (accounts) => {\n    cb(\"userAccount\", accounts[0]);\n  });\n  // Singleton\n  configureMetamaskListeners = () => { };\n};\n\nconst paramMapping = {\n  r: \"dnpName\",\n  v: \"version\",\n  d: \"developerAddress\",\n  h: \"manifestIpfsHash\",\n};\n\nclass Publish extends React.Component {\n  static propTypes = {\n    formFields: PropTypes.array.isRequired,\n  };\n\n  componentDidMount() {\n    const urlQuery = window.location.search.replace(\"?\", \"\")\n    if (urlQuery) {\n      try {\n        const params = parseUrlQuery(urlQuery);\n        console.log(\n          \"A prefilled link was found for the SDK Publish, params:\",\n          params\n        );\n        Object.keys(paramMapping).forEach((key) => {\n          if (params[key])\n            this.props.updateQuery(paramMapping[key], params[key]);\n        });\n      } catch (e) {\n        console.error(`Error parsing urlQuery \"${urlQuery}\": ${e.stack}`);\n      }\n    }\n    configureMetamaskListeners(this.props.updateQuery.bind(this));\n  }\n\n  render() {\n    const id = \"Publish\";\n\n    const buttonInput = this.props.buttonInput;\n    const showManifestButtons = this.props.showManifestButtons;\n    const manifestHash = (showManifestButtons || \"\").split(\"ipfs/\")[1];\n    const disablePublish = this.props.disablePublish;\n\n    const txPreview = this.props.txPreview;\n\n    const getInputClass = ({ loading, success, error }) =>\n      loading ? \"is-loading\" : error ? \"is-invalid\" : success ? \"is-valid\" : \"\";\n\n    return (\n      <div id=\"main\" className=\"app\">\n        <Title title={\"SDK\"} subtitle={id} />\n\n        <SubTitle>Transaction details</SubTitle>\n        <Card>\n          <form>\n            {/* Main rows of the form */}\n            {this.props.formFields\n              .filter(({ hide }) => !hide)\n              .map((item) => {\n                return (\n                  <div className=\"form-group row\" key={item.id}>\n                    <label\n                      htmlFor={`form-${item.id}`}\n                      className=\"col-sm-2 col-form-label\"\n                    >\n                      {item.name}\n                    </label>\n                    <div className=\"col-sm-10\">\n                      <input\n                        className={`form-control ${getInputClass(item)}`}\n                        placeholder={item.placeholder}\n                        value={(this.props.query || {})[item.id] || \"\"}\n                        onChange={(e) =>\n                          this.props.updateQuery(item.id, e.target.value)\n                        }\n                      />\n                      {!item.loading && item.success ? (\n                        <div className=\"valid-feedback\">\n                          {item.success.map((line, i) => (\n                            <span key={i}>\n                              {line}\n                              <br />\n                            </span>\n                          ))}\n                        </div>\n                      ) : null}\n                      {!item.loading && item.error ? (\n                        <div className=\"invalid-feedback\">\n                          {item.error.map((line, i) => (\n                            <span key={i}>\n                              {line}\n                              <br />\n                            </span>\n                          ))}\n                        </div>\n                      ) : null}\n                      <small className=\"form-text text-muted\">\n                        {item.loading ? \"Loading... \" : \"\"}\n                        {item.help}\n                      </small>\n                    </div>\n                  </div>\n                );\n              })}\n\n            {/* Extra buttons to test manifest */}\n            {showManifestButtons ? (\n              <div className=\"form-group row\">\n                <div className=\"col-sm-2\" />\n                <div className=\"col-sm-10\">\n                  <a\n                    className=\"btn btn-outline-dappnode mr-3\"\n                    href={ipfsGateway + manifestHash}\n                    {...newTabProps}\n                  >\n                    Open manifest\n                  </a>\n                  <a\n                    style={{ color: \"inherit\", textDecoration: \"inherit\" }}\n                    href={encodeURIComponent(\"/ipfs/\" + manifestHash)}\n                  >\n                    <button className=\"btn btn-outline-dappnode\">\n                      Install DAppNode Package\n                    </button>\n                  </a>\n                </div>\n              </div>\n            ) : null}\n\n            {/* Transaction preview code box */}\n            {!disablePublish && txPreview ? (\n              <div className=\"form-group row\">\n                <label className=\"col-sm-2 col-form-label text-secondary\">\n                  Transaction preview\n                </label>\n                <div className=\"col-sm-10\">\n                  <div\n                    className=\"error-stack\"\n                    style={{\n                      whiteSpace: \"inherit\",\n                    }}\n                  >\n                    {Object.keys(txPreview).map((key) => (\n                      <span key={key}>\n                        {`${key}: ${txPreview[key]}`}\n                        <br />\n                      </span>\n                    ))}\n                  </div>\n                </div>\n              </div>\n            ) : null}\n\n            {/* Publish button */}\n            <div className=\"form-group row\">\n              <div className=\"col-sm-10\">\n                {buttonInput.connected ? (\n                  <button\n                    className=\"btn btn-dappnode\"\n                    disabled={disablePublish}\n                    onClick={this.props.publish}\n                  >\n                    Publish\n                  </button>\n                ) : (\n                    <button\n                      className=\"btn btn-dappnode\"\n                      onClick={this.props.connectMetamask}\n                    >\n                      <img src={metamaskIcon} alt=\"\" className=\"metamaskIcon\" />{\" \"}\n                    Connect\n                    </button>\n                  )}\n                {buttonInput.connected && buttonInput.error ? (\n                  <div className=\"feedback-error\">\n                    {buttonInput.error.join(\"\\n\")}\n                  </div>\n                ) : buttonInput.connected && buttonInput.success ? (\n                  <div className=\"feedback-success\">\n                    {buttonInput.success.join(\"\\n\")}\n                  </div>\n                ) : null}\n\n                {/* Generic error, for example Metamask connection error */}\n                {this.props.genericError && (\n                  <div className=\"feedback-error\">\n                    {this.props.genericError}\n                  </div>\n                )}\n              </div>\n            </div>\n          </form>\n        </Card>\n      </div>\n    );\n  }\n}\n\n// Container\n\nconst mapStateToProps = createStructuredSelector({\n  registries: selector.registries,\n  repoNames: selector.repoName,\n  query: selector.query,\n  queryResult: selector.queryResult,\n  formFields: selector.getInputFields,\n  buttonInput: selector.getButtonInput,\n  disablePublish: selector.getDisablePublish,\n  showManifestButtons: selector.getShowManifestButtons,\n  txPreview: selector.getTransactionPreview,\n  genericError: selector.getGenericError,\n});\n\n// Uses bindActionCreators to wrap action creators with dispatch\nconst mapDispatchToProps = {\n  validateRepoName,\n  updateQuery,\n  connectMetamask,\n  publish,\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Publish);\n","/**\n * Parses url params into an object\n * Sample params:\n * - timeapp.public.dappnode.eth\n * - 0.1.16\n * - /ipfs/QmSDgpiHco5yXdyVTfhKxr3aiJ82ynz8V14QcGKicM3rVh\n * @param params\n * @returns\n */\nexport const parseUrlQuery = (params = \"\") =>\n  params.split(\"&\").reduce((obj: { [key: string]: string }, pair) => {\n    const [key, value] = pair.split(\"=\");\n    obj[key] = decodeURIComponent(value);\n    return obj;\n  }, {});\n\n/**\n * Reverse of parseUrlQuery, such that:\n *   params = stringifyUrlQuery(parseUrlQuery(params))\n * @param obj\n * @returns params\n */\nexport const stringifyUrlQuery = (obj: { [key: string]: string }) =>\n  Object.keys(obj)\n    .map((key) => `${key}=${encodeURIComponent(obj[key])}`)\n    .join(\"&\");\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { Provider } from \"react-redux\";\nimport store from \"./store\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport \"./layout.css\";\nimport \"./dappnode_styles.css\";\nimport \"./dappnode_colors.css\";\nimport \"./sdk.css\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <App />\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","// IPFS\nexport const ipfsGateway = \"https://ipfs.io\";\n\n// WAMP\nexport const wampUrl = \"ws://my.wamp.dnp.dappnode.eth:8080/ws\";\nexport const wampRealm = \"dappnode_admin\";\n\n// WIFI\nexport const wifiDefaultSSID = \"DAppNodeWIFI\";\nexport const wifiDefaultWPA_PASSPHRASE = \"dappnode\";\nexport const wifiEnvWPA_PASSPHRASE = \"WPA_PASSPHRASE\";\nexport const wifiEnvSSID = \"SSID\";\n\n// DNP names\nexport const wifiName = \"wifi.dnp.dappnode.eth\";\nexport const ipfsName = \"ipfs.dnp.dappnode.eth\";\nexport const coreName = \"core.dnp.dappnode.eth\";\n\n// NACL keys\nexport const adminNaclSecretKey =\n  \"DAppNodeDAppNodeDAppNodeDAppNodeDAppNodeDao=\";\nexport const adminNaclPublicKey =\n  \"cYo1NA7/+PQ22PeqrRNGhs1B84SY/fuomNtURj5SUmQ=\";\n\n// TEMP TAGS\nexport const MOUNTPOINT_DEVICE_LEGACY_TAG = \"legacy:\";\nexport const USER_SETTING_DISABLE_TAG = \"disable:\";\n\n// WEB3\nexport const fullnodeHttpJsonRpc = \"http://fullnode.dappnode:8545\";\n\n// URLs / Links\nexport const surveyUrl = \"https://goo.gl/forms/DSy1J1OlQGpdyhD22\";\nexport const packageSurveyLink = \"https://goo.gl/forms/EjVTHu6UBWBk60Z62\";\n\n// AutoUpdate IDSs\nexport const autoUpdateIds = {\n  MY_PACKAGES: \"my-packages\",\n  SYSTEM_PACKAGES: \"system-packages\",\n};\n\n// VPN\nexport const superAdminId = \"dappnode_admin\";\n\n// Support, where to send issues\nconst githubRepo = \"DNP_ADMIN\";\nconst githubUsername = \"dappnode\";\nexport const issueBaseUrl = `https://github.com/${githubUsername}/${githubRepo}/issues/new`;\n"],"sourceRoot":""}