(this.webpackJsonppublish=this.webpackJsonppublish||[]).push([[0],{16:function(e,t,n){"use strict";var a=n(49),r=n.n(a),s=n(67);t.a=Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_MOCK_DATA||Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).TEST?{}:new r.a(s.a)},208:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return c}));var a=n(16),r=n(39),s=n(25);function c(t){try{return function(t){var n=t.ensName,c=t.manifestIpfsHash,o=t.version,i=t.developerAddress,u=t.registryAddress,p=t.repoAddress;if(!c)throw Error("manifestIpfsHash must be defined: ".concat(c));var l="0x"+e.from(c,"utf8").toString("hex"),d=n.split(".")[0];if(!u)throw Error("There must exist a registry for DAppNode Package name ".concat(n));if(p){var f=new a.a.eth.Contract(s.abi,p).methods.newVersion(o.split("."),"0x0000000000000000000000000000000000000000",l);return{To:p,Value:0,Data:f.encodeABI(),"Gas limit":3e5}}var m=new a.a.eth.Contract(r.abi,u).methods.newRepoWithVersion(d,i,o.split("."),"0x0000000000000000000000000000000000000000",l);return{To:u,Value:0,Data:m.encodeABI(),"Gas limit":11e5}}(t)}catch(n){return{error:"Error generating tx: ".concat(n.message)}}}}).call(this,n(2).Buffer)},211:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return i}));var a=n(4),r=n.n(a),s=n(14),c=n(39),o=n(25);function i(e,t){return u.apply(this,arguments)}function u(){return(u=Object(s.a)(r.a.mark((function t(n,a){var s,i,u,p,l,d,f,m,b,y,v,h,E,w;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=a.dnpName,i=a.version,u=a.manifestIpfsHash,p=a.developerAddress,l=a.registryAddress,d=a.repoAddress,s){t.next=3;break}throw Error("dnpName must be defined");case 3:if(i){t.next=5;break}throw Error("version must be defined");case 5:if(u){t.next=7;break}throw Error("manifestIpfsHash must be defined");case 7:if(l){t.next=9;break}throw Error("registryAddress must be defined");case 9:if(u||p){t.next=11;break}throw Error("developerAddress or repoAddress must be defined");case 11:return f="0x"+e.from(u,"utf8").toString("hex"),m="0x0000000000000000000000000000000000000000",b=s.split(".")[0],t.next=16,n.eth.getAccounts().then((function(e){return e[0]}));case 16:if(y=t.sent,!d){t.next=25;break}return v=new n.eth.Contract(o.abi,d),t.next=21,v.methods.newVersion(i.split("."),m,f).send({from:y,gas:3e5,value:0});case 21:h=t.sent,console.log("got txHash",h),t.next=30;break;case 25:return E=new n.eth.Contract(c.abi,l),t.next=28,E.methods.newRepoWithVersion(b,p,i.split("."),m,f).send({from:y,gas:11e5,value:0});case 28:w=t.sent,console.log("got txHash",w);case 30:case"end":return t.stop()}}),t)})))).apply(this,arguments)}}).call(this,n(2).Buffer)},215:function(e,t){e.exports="data:image/png;base64,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"},222:function(e,t,n){e.exports=n(514)},25:function(e){e.exports=JSON.parse('{"contract_name":"repository","address":"dynamic","abi":[{"constant":true,"inputs":[{"name":"_semanticVersion","type":"uint16[3]"}],"name":"getBySemanticVersion","outputs":[{"name":"semanticVersion","type":"uint16[3]"},{"name":"contractAddress","type":"address"},{"name":"contentURI","type":"bytes"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"EVMSCRIPT_REGISTRY_APP_ID","outputs":[{"name":"","type":"bytes32"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_newSemanticVersion","type":"uint16[3]"},{"name":"_contractAddress","type":"address"},{"name":"_contentURI","type":"bytes"}],"name":"newVersion","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"_versionId","type":"uint256"}],"name":"getByVersionId","outputs":[{"name":"semanticVersion","type":"uint16[3]"},{"name":"contractAddress","type":"address"},{"name":"contentURI","type":"bytes"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"appId","outputs":[{"name":"","type":"bytes32"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"getInitializationBlock","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"_contractAddress","type":"address"}],"name":"getLatestForContractAddress","outputs":[{"name":"semanticVersion","type":"uint16[3]"},{"name":"contractAddress","type":"address"},{"name":"contentURI","type":"bytes"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"EVMSCRIPT_REGISTRY_APP","outputs":[{"name":"","type":"bytes32"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"_sender","type":"address"},{"name":"_role","type":"bytes32"},{"name":"params","type":"uint256[]"}],"name":"canPerform","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"_oldVersion","type":"uint16[3]"},{"name":"_newVersion","type":"uint16[3]"}],"name":"isValidBump","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"pure","type":"function"},{"constant":true,"inputs":[],"name":"CREATE_VERSION_ROLE","outputs":[{"name":"","type":"bytes32"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"getLatest","outputs":[{"name":"semanticVersion","type":"uint16[3]"},{"name":"contractAddress","type":"address"},{"name":"contentURI","type":"bytes"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"getVersionsCount","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"kernel","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"_script","type":"bytes"}],"name":"getExecutor","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"anonymous":false,"inputs":[{"indexed":false,"name":"versionId","type":"uint256"},{"indexed":false,"name":"semanticVersion","type":"uint16[3]"}],"name":"NewVersion","type":"event"}]}')},265:function(e,t){},325:function(e,t){},327:function(e,t){},388:function(e,t){},39:function(e){e.exports=JSON.parse('{"contract_name":"registry","address":"0x266bfdb2124a68beb6769dc887bd655f78778923","deployBlock":5254891,"abi":[{"constant":true,"inputs":[],"name":"REPO_APP_NAME","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"APM_APP_NAME","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"ENS_SUB_APP_NAME","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"registrar","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_name","type":"string"},{"name":"_dev","type":"address"},{"name":"_initialSemanticVersion","type":"uint16[3]"},{"name":"_contractAddress","type":"address"},{"name":"_contentURI","type":"bytes"}],"name":"newRepoWithVersion","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"CREATE_REPO_ROLE","outputs":[{"name":"","type":"bytes32"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"EVMSCRIPT_REGISTRY_APP_ID","outputs":[{"name":"","type":"bytes32"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"appId","outputs":[{"name":"","type":"bytes32"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"getInitializationBlock","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"EVMSCRIPT_REGISTRY_APP","outputs":[{"name":"","type":"bytes32"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"_sender","type":"address"},{"name":"_role","type":"bytes32"},{"name":"params","type":"uint256[]"}],"name":"canPerform","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_name","type":"string"},{"name":"_dev","type":"address"}],"name":"newRepo","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_registrar","type":"address"}],"name":"initialize","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_kernel","type":"address"},{"name":"_appId","type":"bytes32"},{"name":"_initializePayload","type":"bytes"}],"name":"newAppProxyPinned","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"kernel","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_kernel","type":"address"},{"name":"_appId","type":"bytes32"}],"name":"newAppProxy","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_kernel","type":"address"},{"name":"_appId","type":"bytes32"},{"name":"_initializePayload","type":"bytes"}],"name":"newAppProxy","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"_script","type":"bytes"}],"name":"getExecutor","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_kernel","type":"address"},{"name":"_appId","type":"bytes32"}],"name":"newAppProxyPinned","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"anonymous":false,"inputs":[{"indexed":false,"name":"id","type":"bytes32"},{"indexed":false,"name":"name","type":"string"},{"indexed":false,"name":"repo","type":"address"}],"name":"NewRepo","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"proxy","type":"address"}],"name":"NewAppProxy","type":"event"}]}')},508:function(e,t,n){},510:function(e,t,n){},511:function(e,t,n){},512:function(e,t,n){},513:function(e,t,n){},514:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(86),c=n.n(s),o=n(88),i=n(38),u=n(218),p=n(26),l=n(219),d=n(4),f=n.n(d),m=n(24),b=n(14),y=n(7),v=function(e,t){var n={};return t.forEach((function(t){n[t]=e+"/"+t})),n}("page-sdk",["UPDATE_REGISTRY","UPDATE_REPO","FETCH_REGISTRY","VALIDATE_REPO_NAME","UPDATE_REPO_NAME","UPDATE_QUERY","UPDATE_QUERY_RESULT","CONNECT_METAMASK","PUBLISH","UPDATE_UI_MESSAGE"]);var h=function(e,t){return{type:v.UPDATE_REGISTRY,registryEns:e,data:t}},E=function(e,t,n){return{type:v.UPDATE_REPO,registryEns:e,repoName:t,data:n}},w=function(e,t){return{type:v.UPDATE_QUERY,id:e,value:t}},A=function(e,t){return{type:v.UPDATE_QUERY_RESULT,id:e,data:t}},g=function(e){return{type:v.UPDATE_QUERY_RESULT,id:"genericError",data:e}},x=n(68),O=n.n(x),j=n(13),P=n.n(j),k=n(207),N=n.n(k);function S(e){return!(!e||"string"!==typeof e)&&(e.includes("ipfs/")&&(e=e.split("ipfs/")[1]),e.replace("/",""),function(e){return N.a.cid(e)}(e))}var _=function(e,t){return!(!e||"string"!==typeof e)&&(!(!t||"string"!==typeof t)&&e.toLowerCase().includes(t.toLowerCase()))},T=n(208),I=function(e){return e.query},R=function(e){return e.queryResult},M=function(e){return[Object(m.a)({id:"dnpName",name:"DAppNode Package name",placeholder:"full ENS name",help:"Full ENS name of the DAppNode Package to update, i.e. timeapp.public.dappnode.eth"},U(e)),Object(m.a)({id:"developerAddress",name:"Developer address",placeholder:"Ethereum address",help:"Ethereum address of the developer address that will control this repo"},C(e)),Object(m.a)({id:"version",name:"Next version",placeholder:"Semantic version",help:"Semantic version about to be published, i.e. 0.1.7"},V(e)),Object(m.a)({id:"manifestIpfsHash",name:"Manifest hash",placeholder:"IPFS multihash",help:"Multihash content address of the manifest. Must be in the format /ipfs/[multihash], i.e. /ipfs/QmVeaz5kR55nAiGjYpXpUAJpWvf6net4MbGFNjBfMTS8xS"},L(e))]},D=function(e){var t=I(e).dnpName,n=R(e).repoInfo;return(n||{}).value&&n.value===t?n:null};function U(e){var t=I(e).dnpName,n=D(e),a=[],r=[];if(t&&!_(t,".")&&a.push('"'.concat(t,'" is not a valid ENS domain')),t&&n){var s=n.registryAddress,c=n.repoAddress,o=n.latestVersion;s?r.push("Registry found: ".concat(s)):a.push('"'.concat(t,'" does not have a valid registry')),c?r.push("Repo already deployed at: ".concat(c)):r.push('A new repo will be deployed for the DAppNode Package "'.concat(t,'"')),o&&r.push("Latest version: ".concat(o))}return q({error:a,success:r})}function V(e){var t,n=I(e).version,a=(D(e)||{}).latestVersion,r=[],s=[];if(n&&(O.a.valid(n)?s.push("Valid version"):r.push("Sematic version must be valid, i.e. 0.1.7")),O.a.valid(n)&&a){var c=function(e,t){for(var n=0,a=["patch","minor","major"];n<a.length;n++){var r=a[n];if(O.a.inc(e,r)===t)return r}}(a,n);c?s.push('Valid bump of type "'.concat(c,'"')):r.push("Next version is not a valid bump. Must be ".concat((t=a,["patch","minor","major"].map((function(e){return O.a.inc(t,e)})).join(", "))))}return q({error:r,success:s})}function C(e){var t=I(e).developerAddress,n=D(e)||{},a=n.registryAddress,r=n.repoAddress,s=[],c=[];return t&&(P.a.isAddress(t)?c.push("Valid address"):s.push("Must be a valid ethereum address")),q({error:s,success:c,hide:!a||r})}function L(e){var t=I(e).manifestIpfsHash,n=I(e).version,a=I(e).dnpName,r=function(e){return R(e).manifest}(e),s=[],c=[];t&&(S(t)?c.push("Valid ipfs hash"):s.push("Manifest hash must be a valid IPFS hash"));var o=(r||{}).manifest;return r&&t&&t===r.hash&&o&&o.name&&o.version&&n&&a&&(o.name===a&&o.version===n?c.push("Manifest successfully verified"):s.push("Manifest verification failed. This manifest is for ".concat(o.name," @ ").concat(o.version))),q({error:s,success:c})}function B(e){var t=D(e),n=function(e){return R(e).metamaskInfo}(e),a=function(e){return R(e).allowedAddress}(e),r=function(e){return R(e).call}(e),s=window.ethereum,c=[],o=[];if(n){var i=n.networkId||(s||{}).networkVersion;i&&"1"!==String(i)&&c.push('Transactions must be published on mainnet. Please select "Main Network" on the metamask extension')}var u,p=(n||{}).connected,l=(s||{}).selectedAddress;return t&&a&&t.repoAddress&&l&&_(t.repoAddress,a.repoAddress)&&_(l,a.userAddress)&&(a.isAllowed?o.push("Selected address ".concat(l," is allowed to publish")):(c.push("Selected address ".concat(l," is not allowed to publish")),u=!0)),r&&("success"===r.type&&o.push(r.message),"error"===r.type&&c.push(r.message)),q({error:c,success:o,connected:p,addressNotAllowed:u})}function q(e){for(var t=0,n=Object.keys(e);t<n.length;t++){var a=n[t];Array.isArray(e[a])&&!e[a].length&&(e[a]=null)}return e}var H=n(209),z=n(39),K=n(16);function G(){return(G=Object(b.a)(f.a.mark((function e(t){var n,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw Error("registryAddress must be defined");case 2:if(P.a.isAddress(t)){e.next=4;break}throw Error("registryAddress must be an address: ".concat(t));case 4:return n=new K.a.eth.Contract(z.abi,t),e.next=7,n.getPastEvents("NewRepo",{fromBlock:z.deployBlock}).then(X);case 7:return a=e.sent,e.abrupt("return",a.filter((function(e){var n=e.returnValues.name||"";return(!_(t,"0x266bfdb2124a68beb6769dc887bd655f78778923")||!_(n,"."))&&!n.startsWith("apm-")})).map((function(e){var t=e.returnValues;return{id:t.id,name:t.name,address:t.repo,blockNumber:e.blockNumber}})).reduce((function(e,t){return e[t.name]=t,e}),{}));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function X(e){var t,n={},a=Object(H.a)(e);try{for(a.s();!(t=a.n()).done;){var r=t.value,s=r.returnValues.id;(!n[s]||r.blockNumber>n[s].blockNumber)&&(n[s]=r)}}catch(c){a.e(c)}finally{a.f()}return Object.values(n)}var W=function(e){return G.apply(this,arguments)};var Q=n(25),Y={year:"numeric",month:"short",day:"numeric"};function F(e){return function(e){return K.a.eth.getBlock(e).catch((function(t){return console.error("Error getting timestamp for blockNumber ".concat(e," ").concat(t.stack))})).then((function(e){return parseInt((e||{}).timestamp||0,10)}))}(e).then((function(e){return new Intl.DateTimeFormat("en-US",Y).format(1e3*e)}))}function J(e,t){return e.methods.getBySemanticVersion(t).call().then((function(e){return K.a.utils.hexToAscii(e.contentURI)})).catch((function(e){return"Couldn't decode uint16 from ABI: 0x"===e.message?"NOT_VALID_VERSION":e.message}))}function Z(e){return K.a.eth.getTransaction(e).then((function(e){return e.from}))}function $(){return($=Object(b.a)(f.a.mark((function e(t){var n,a,r,s,c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.blockNumber,a=t.address,r=new K.a.eth.Contract(Q.abi,a),e.next=4,r.getPastEvents("NewVersion",{fromBlock:String(n)});case 4:return s=e.sent,e.next=7,Promise.all(s.reverse().map(function(){var e=Object(b.a)(f.a.mark((function e(t){var n,a,s,c,o,i;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.returnValues.semanticVersion,e.next=3,Promise.all([F(t.blockNumber),Z(t.transactionHash),J(r,n)]);case 3:return a=e.sent,s=Object(p.a)(a,3),c=s[0],o=s[1],i=s[2],e.abrupt("return",{version:n.join("."),blockNumber:t.blockNumber,date:c,sender:o,contentUri:i});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 7:return c=e.sent,e.next=10,F(n);case 10:return e.t0=e.sent,e.t1=c.reduce((function(e,t){return e[t.version]=t,e}),{}),e.abrupt("return",{date:e.t0,versions:e.t1});case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ee=function(e){return $.apply(this,arguments)},te=n(210),ne=n.n(te);var ae=function(){if(Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_MOCK_DATA||Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).TEST)return{};var e=K.a.currentProvider;return e.sendAsync=e.sendAsync||e.send,new ne.a(e)}();function re(e){return se.apply(this,arguments)}function se(){return(se=Object(b.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ae.resolver(t).addr();case 3:return e.abrupt("return",e.sent);case 6:if(e.prev=6,e.t0=e.catch(0),!_((e.t0||{}).message,"not found")){e.next=12;break}return e.abrupt("return",null);case 12:throw e.t0;case 13:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)}function ce(){return(ce=Object(b.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new K.a.eth.Contract(Q.abi,t),e.next=3,n.methods.getLatest().call().then((function(e){return e.semanticVersion.join(".")})).catch((function(e){throw e.message="Error getting latest version of ".concat(t,": ").concat(e.message),e}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function oe(){return(oe=Object(b.a)(f.a.mark((function e(t,n){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new K.a.eth.Contract(Q.abi,t),e.next=3,a.methods.canPerform(n,"0x0000000000000000000000000000000000000000000000000000000000000001",[]).call().catch((function(e){throw e.message="Error checking if account ".concat(n," is allowed at ").concat(t,": ").concat(e.message),e}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ie=function(e){return ce.apply(this,arguments)},ue=function(e,t){return oe.apply(this,arguments)},pe=n(49),le=n.n(pe);function de(){return fe.apply(this,arguments)}function fe(){return(fe=Object(b.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.ethereum){e.next=6;break}return e.next=3,window.ethereum.enable();case 3:return e.abrupt("return",new le.a(window.ethereum));case 6:if(!window.web3){e.next=10;break}return e.abrupt("return",new le.a(window.web3.currentProvider));case 10:throw Error("Non-Ethereum browser detected. Please, install MetaMask");case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var me=n(211),be=n(67),ye=f.a.mark(ge),ve=f.a.mark(Pe),he=f.a.mark(Se),Ee=f.a.mark(Te);function we(e){return Ae.apply(this,arguments)}function Ae(){return(Ae=Object(b.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(be.b).concat(t,"/dappnode_package.json")).then((function(e){return e.json()}));case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),e.next=10,fetch("".concat(be.b).concat(t)).then((function(e){return e.json()}));case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)}function ge(){var e,t,n,a,r,s,c;return f.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,Object(y.d)(g(null));case 3:return console.log("Connecting to metamask..."),o.next=6,Object(y.b)(de);case 6:return e=o.sent,o.next=9,Object(y.b)(e.eth.net.getId);case 9:return t=o.sent,o.next=12,Object(y.b)(e.eth.getAccounts);case 12:return n=o.sent,a=n[0],o.next=16,Object(y.d)(A("metamaskInfo",{userAddress:a,networkId:t,connected:!0}));case 16:return o.next=18,Object(y.d)(w("userAccount",a));case 18:return o.prev=19,o.next=22,Object(y.f)(v.PUBLISH);case 22:return o.next=24,Object(y.e)(I);case 24:return r=o.sent,o.next=27,Object(y.e)(D);case 27:return s=o.sent,o.next=30,Object(y.b)(me.a,e,Object(m.a)({},r,{},s));case 30:c=o.sent,A("call",{type:"success",message:"Tx successfully executed. Tx hash: ".concat(c)}),o.next=39;break;case 34:return o.prev=34,o.t0=o.catch(19),console.error("Error executing transaction: ".concat(o.t0.stack)),o.next=39,Object(y.d)(A("call",{type:"error",message:"Error executing transaction: ".concat(o.t0.message)}));case 39:return o.next=41,Object(y.b)(y.c,500);case 41:o.next=18;break;case 43:o.next=50;break;case 45:return o.prev=45,o.t1=o.catch(0),console.error("Error connecting to metamask: ",o.t1.stack),o.next=50,Object(y.d)(g("Error connecting to metamask: ".concat(o.t1.message)));case 50:case"end":return o.stop()}}),ye,null,[[0,45],[19,34]])}function xe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return(e||"").split(".").slice(1).join(".")}function Oe(e){return je.apply(this,arguments)}function je(){return(je=Object(b.a)(f.a.mark((function e(t){var n,a,r,s,c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=xe(t),e.next=3,Promise.all([t,n].map(re));case 3:return a=e.sent,r=Object(p.a)(a,2),s=r[0],c=r[1],e.abrupt("return",{repoAddress:s,registryAddress:c});case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Pe(e){var t,n,a;return f.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t=e.registryEns,r.prev=1,t){r.next=4;break}throw Error("registryEns must be defined");case 4:return r.next=6,Object(y.d)(h(t,{name:t,fetching:!0}));case 6:return r.next=8,Object(y.b)(re,t);case 8:return n=r.sent,r.next=11,Object(y.d)(h(t,{address:n}));case 11:return r.next=13,Object(y.b)(W,n);case 13:return a=r.sent,r.next=16,Object(y.d)(h(t,{repos:a,fetching:!1}));case 16:return r.next=18,Object(y.a)(Object.values(a).map((function(e){return Object(y.b)(f.a.mark((function n(){var a;return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(y.d)(E(t,e.name,{fetching:!0}));case 2:return n.next=4,Object(y.b)(ee,e);case 4:return a=n.sent,n.next=7,Object(y.d)(E(t,e.name,Object(m.a)({},a,{fetching:!1})));case 7:case"end":return n.stop()}}),n)})))})));case 18:r.next=23;break;case 20:r.prev=20,r.t0=r.catch(1),console.error('Error fetching registry "'.concat(t,'": ').concat(r.t0.stack));case 23:case"end":return r.stop()}}),ve,null,[[1,20]])}var ke={dnpName:f.a.mark((function e(t){var n,a,r,s,c,o,i,u;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,a=t.value,e.prev=1,e.next=4,Object(y.b)(Oe,a);case 4:return r=e.sent,s=r.repoAddress,c=r.registryAddress,e.next=9,Object(y.d)(A("repoInfo",{value:a,repoAddress:s,registryAddress:c}));case 9:if(!s){e.next=17;break}return e.next=12,Object(y.b)(ie,s);case 12:return o=e.sent,e.next=15,Object(y.d)(A("repoInfo",{latestVersion:o}));case 15:e.next=20;break;case 17:if(!c){e.next=20;break}return e.next=20,Object(y.d)(A("repoInfo",{latestVersion:"0.0.0"}));case 20:if(i=(window.ethereum||{}).selectedAddress,!s||!i){e.next=27;break}return e.next=24,Object(y.b)(ue,s,i);case 24:return u=e.sent,e.next=27,Object(y.d)(A("allowedAddress",{userAddress:i,repoAddress:s,isAllowed:u}));case 27:e.next=32;break;case 29:e.prev=29,e.t0=e.catch(1),console.error("Error on update query for ".concat(n," = ").concat(a,": ").concat(e.t0.stack));case 32:case"end":return e.stop()}}),e,null,[[1,29]])})),userAddress:f.a.mark((function e(t){var n,a,r,s,c,o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,a=t.value,e.prev=1,e.next=4,Object(y.e)(D);case 4:if(r=e.sent,s=(r||{}).repoAddress,c=a,!s||!c){e.next=13;break}return e.next=10,Object(y.b)(ue,s,c);case 10:return o=e.sent,e.next=13,Object(y.d)(A("allowedAddress",{userAddress:c,repoAddress:s,isAllowed:o}));case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(1),console.error("Error on update query for ".concat(n," = ").concat(a,": ").concat(e.t0.stack));case 18:case"end":return e.stop()}}),e,null,[[1,15]])})),manifestIpfsHash:f.a.mark((function e(t){var n,a,r,s;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,a=t.value,e.prev=1,r=a,e.next=5,Object(y.b)(we,r);case 5:return s=e.sent,e.next=8,Object(y.d)(A("manifest",{hash:a,manifest:s}));case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.error("Error on update query for ".concat(n," = ").concat(a,": ").concat(e.t0.stack));case 13:case"end":return e.stop()}}),e,null,[[1,10]])}))},Ne=function(e){return"".concat(v.UPDATE_QUERY,"_").concat(e)};function Se(e){var t,n;return f.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return t=e.id,n=e.value,a.prev=1,a.next=4,Object(y.d)({type:Ne(t),id:t,value:n});case 4:a.next=9;break;case 6:a.prev=6,a.t0=a.catch(1),console.error("Error on update query for ".concat(t," = ").concat(n,": ").concat(a.t0.stack));case 9:case"end":return a.stop()}}),he,null,[[1,6]])}var _e=[[v.FETCH_REGISTRY,Pe],[v.UPDATE_QUERY,Se]].concat(Object(l.a)(Object.keys(ke).map((function(e){return[Ne(e),ke[e]]}))),[[v.CONNECT_METAMASK,ge]]);function Te(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(y.a)(_e.map((function(e){var t=Object(p.a)(e,2),n=t[0],a=t[1];return Object(y.g)(n,a)})));case 2:case"end":return e.stop()}}),Ee)}var Ie=n(20),Re=n(40),Me=n.n(Re),De={registries:{},repoName:{},query:{},queryResult:{},uiMessage:{}},Ue=Object(u.a)(),Ve=[Ue],Ce=Object(i.d)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:De,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case v.UPDATE_REGISTRY:return Me()(e,{registries:Object(Ie.a)({},t.registryEns,t.data)});case v.UPDATE_REPO:return Me()(e,{registries:Object(Ie.a)({},t.registryEns,{repos:Object(Ie.a)({},t.repoName,t.data)})});case v.UPDATE_REPO_NAME:return Me()(e,{repoName:Object(Ie.a)({},t.repoName,t.data)});case v.UPDATE_QUERY:return Me()(e,{query:Object(Ie.a)({},t.id,t.value)});case v.UPDATE_QUERY_RESULT:return Me()(e,{queryResult:Object(Ie.a)({},t.id,t.data)});case v.UPDATE_UI_MESSAGE:return Me()(e,{uiMessage:Object(Ie.a)({},t.uiId,t.message)});default:return e}}),i.a.apply(void 0,Ve));window.dispach=Ce.dispatch,window.store=Ce;var Le=Ce;Ue.run(Te);n(508);var Be=n(212),qe=n(213),He=n(217),ze=n(220),Ke=n(214),Ge=n(215),Xe=n.n(Ge),We={rel:"noopener noreferrer",target:"_blank"},Qe=function(e){var t=e.title,n=e.subtitle,a=e.children;return a?r.a.createElement("div",{className:"section-title"},a):n?r.a.createElement("div",{className:"section-title"},r.a.createElement("span",{className:"pre-title"},t," "),n):r.a.createElement("div",{className:"section-title"},t)},Ye=function(e){var t=e.children,n=e.className;return r.a.createElement("div",{className:"section-subtitle ".concat(n||"")},t)},Fe=n(221),Je=n(125);function Ze(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((function(e,t){if("string"===typeof t&&e.push(t),"object"===typeof t)for(var n=0,a=Object.entries(t||{});n<a.length;n++){var r=Object(p.a)(a[n],2),s=r[0];r[1]&&e.push(s)}return e}),[]).join(" ")}var $e={boxShadow:"1px 1px 15px 0 rgba(0, 0, 0, 0.07)"},et=function(e){var t=e.children,n=e.className,a=void 0===n?"":n,s=e.shadow,c=e.spacing,o=e.divider,i=e.noscroll,u=Object(Fe.a)(e,["children","className","shadow","spacing","divider","noscroll"]);return r.a.createElement(Je.a,{style:Object(m.a)({overflowX:i?"visible":"auto"},s?$e:{})},r.a.createElement(Je.a.Body,Object.assign({className:Ze(Object(Ie.a)({spacing:c,divider:o,noscroll:i},a,a))},u),t))},tt=function(e){window.ethereum&&(window.ethereum.on("accountsChanged",(function(t){e("userAccount",t[0])})),tt=function(){})},nt={r:"dnpName",v:"version",d:"developerAddress",h:"manifestIpfsHash"},at=function(e){Object(ze.a)(n,e);var t=Object(He.a)(n);function n(){return Object(Be.a)(this,n),t.apply(this,arguments)}return Object(qe.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=window.location.search.replace("?","");if(t)try{var n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.split("&").reduce((function(e,t){var n=t.split("="),a=Object(p.a)(n,2),r=a[0],s=a[1];return e[r]=decodeURIComponent(s),e}),{})}(t);console.log("A prefilled link was found for the SDK Publish, params:",n),Object.keys(nt).forEach((function(t){n[t]&&e.props.updateQuery(nt[t],n[t])}))}catch(a){console.error('Error parsing urlQuery "'.concat(t,'": ').concat(a.stack))}tt(this.props.updateQuery.bind(this))}},{key:"render",value:function(){var e=this,t=this.props.buttonInput,n=this.props.showManifestButtons,a=(n||"").split("ipfs/")[1],s=this.props.disablePublish,c=this.props.txPreview,o=function(e){var t=e.loading,n=e.success,a=e.error;return t?"is-loading":a?"is-invalid":n?"is-valid":""};return r.a.createElement("div",{id:"main",className:"app"},r.a.createElement(Qe,{title:"SDK",subtitle:"Publish"}),r.a.createElement(Ye,null,"Transaction details"),r.a.createElement(et,null,r.a.createElement("form",null,this.props.formFields.filter((function(e){return!e.hide})).map((function(t){return r.a.createElement("div",{className:"form-group row",key:t.id},r.a.createElement("label",{htmlFor:"form-".concat(t.id),className:"col-sm-2 col-form-label"},t.name),r.a.createElement("div",{className:"col-sm-10"},r.a.createElement("input",{className:"form-control ".concat(o(t)),placeholder:t.placeholder,value:(e.props.query||{})[t.id]||"",onChange:function(n){return e.props.updateQuery(t.id,n.target.value)}}),!t.loading&&t.success?r.a.createElement("div",{className:"valid-feedback"},t.success.map((function(e,t){return r.a.createElement("span",{key:t},e,r.a.createElement("br",null))}))):null,!t.loading&&t.error?r.a.createElement("div",{className:"invalid-feedback"},t.error.map((function(e,t){return r.a.createElement("span",{key:t},e,r.a.createElement("br",null))}))):null,r.a.createElement("small",{className:"form-text text-muted"},t.loading?"Loading... ":"",t.help)))})),n?r.a.createElement("div",{className:"form-group row"},r.a.createElement("div",{className:"col-sm-2"}),r.a.createElement("div",{className:"col-sm-10"},r.a.createElement("a",Object.assign({className:"btn btn-outline-dappnode mr-3",href:"http://my.ipfs.dnp.dappnode.eth:8080/ipfs/"+a},We),"Open manifest"),r.a.createElement("a",{style:{color:"inherit",textDecoration:"inherit"},href:encodeURIComponent("/ipfs/"+a)},r.a.createElement("button",{className:"btn btn-outline-dappnode"},"Install DAppNode Package")))):null,!s&&c?r.a.createElement("div",{className:"form-group row"},r.a.createElement("label",{className:"col-sm-2 col-form-label text-secondary"},"Transaction preview"),r.a.createElement("div",{className:"col-sm-10"},r.a.createElement("div",{className:"error-stack",style:{whiteSpace:"inherit"}},Object.keys(c).map((function(e){return r.a.createElement("span",{key:e},"".concat(e,": ").concat(c[e]),r.a.createElement("br",null))}))))):null,r.a.createElement("div",{className:"form-group row"},r.a.createElement("div",{className:"col-sm-10"},t.connected?r.a.createElement("button",{className:"btn btn-dappnode",disabled:s,onClick:this.props.publish},"Publish"):r.a.createElement("button",{className:"btn btn-dappnode",onClick:this.props.connectMetamask},r.a.createElement("img",{src:Xe.a,alt:"",className:"metamaskIcon"})," ","Connect"),t.connected&&t.error?r.a.createElement("div",{className:"feedback-error"},t.error.join("\n")):t.connected&&t.success?r.a.createElement("div",{className:"feedback-success"},t.success.join("\n")):null,this.props.genericError&&r.a.createElement("div",{className:"feedback-error"},this.props.genericError))))))}}]),n}(r.a.Component),rt=Object(Ke.a)({registries:function(e){return e.registries},repoNames:function(e){return e.repoName},query:function(e){return e.query},queryResult:function(e){return e.queryResult},formFields:M,buttonInput:B,disablePublish:function(e){var t=M(e).filter((function(e){return!e.hide})).reduce((function(e,t){return e||t.error||!t.success}),!1),n=(B(e)||{}).addressNotAllowed;return t||n},showManifestButtons:function(e){var t=L(e),n=I(e).manifestIpfsHash;return!t.error&&t.success?n:null},txPreview:function(e){var t=I(e),n=D(e),a=t||{},r=a.dnpName,s=a.developerAddress,c=a.version,o=a.manifestIpfsHash,i=n||{},u=i.registryAddress,p=i.repoAddress;return r&&c&&o&&u&&(p||s)?Object(T.a)({ensName:r,manifestIpfsHash:o,version:c,developerAddress:s,registryAddress:u,repoAddress:p}):null},genericError:function(e){return(R(e)||{}).genericError}}),st={validateRepoName:function(e){return{type:v.VALIDATE_REPO_NAME,repoName:e}},updateQuery:w,connectMetamask:function(){return{type:v.CONNECT_METAMASK}},publish:function(){return{type:v.PUBLISH}}},ct=Object(o.b)(rt,st)(at);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(509),n(510),n(511),n(512),n(513);c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(o.a,{store:Le},r.a.createElement(ct,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},67:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return r}));var a="https://ipfs.io",r="http://fullnode.dappnode:8545";"https://github.com/".concat("dappnode","/").concat("DNP_ADMIN","/issues/new")}},[[222,1,2]]]);
//# sourceMappingURL=main.06ecaf96.chunk.js.map